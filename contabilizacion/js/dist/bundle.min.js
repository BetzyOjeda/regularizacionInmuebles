var helpScoolTooltip,municipalityTransactions={},stateTransactions=[],dommySchools={cct:["11AAA1111A","11BBB1111B","11CCC1111C"],isDommy:function(e){_isD=!1;for(var a=0;a<dommySchools.cct.length;a++)if(e==dommySchools.cct[a]){_isD=!0;break}return _isD},getDommyCCT:function(){return _programID=moduleInitData.announcement.scholarshipProgram.id,"1"==_programID?dommySchools.cct[0]:"2"==_programID?dommySchools.cct[1]:"7"==_programID?dommySchools.cct[2]:""},getDommyDescription:function(){switch(_descSt="",moduleInitData.announcement.scholarshipProgram.id){case"1":_descSt="PENDIENTE SECUNDARIA";break;case"2":_descSt="PENDIENTE BACHILLERATO";break;case"7":_descSt="PENDIENTE UNIVERSIDAD"}return _descSt}},dataStudent={},fbdate=!0,fcdate=!0,family={fromhome:{total:0,members:[],index:function(){return family.fromhome.getTotal()+1},getTotal:function(){for(_t=0,_p=0;_p<family.fromhome.members.length;_p++)_fam0=family.fromhome.members[_p],"Delete"!=_fam0.statusRelated&&_t++;return _t},getMembers:function(){for(_tMem=[],_p=0;_p<family.fromhome.members.length;_p++)_fam0=family.fromhome.members[_p],"Delete"!=_fam0.statusRelated&&_tMem.push(_fam0);return _tMem}},awayfromhome:{total:0,members:[],index:function(){return family.awayfromhome.getTotal()+1},getTotal:function(){for(_t=0,_p=0;_p<family.awayfromhome.members.length;_p++)_fam0=family.awayfromhome.members[_p],"Delete"!=_fam0.statusRelated&&_t++;return _t},getMembers:function(){for(_tMem=[],_p=0;_p<family.awayfromhome.members.length;_p++)_fam0=family.awayfromhome.members[_p],"Delete"!=_fam0.statusRelated&&_tMem.push(_fam0);return _tMem}},bbva:{member:{}},unregistered:!0},firstModuleComplete=!1,scholsEmail={1:"becas_aguascalientes.mx@bbva.com",2:"becas_bc.mx@bbva.com",3:"becas_bcs.mx@bbva.com",4:"becas_campeche.mx@bbva.com",5:"becas_coahuila.mx@bbva.com",6:"becas_colima.mx@bbva.com",7:"becas_chiapas.mx@bbva.com",8:"becas_chihuahua.mx@bbva.com",9:"becas_cdmx.mx@bbva.com",10:"becas_durango.mx@bbva.com",11:"becas_guanajuato.mx@bbva.com",12:"becas_guerrero.mx@bbva.com",13:"becas_hidalgo.mx@bbva.com",14:"becas_jalisco.mx@bbva.com",15:"becas_edomex.mx@bbva.com",16:"becas_michoacan.mx@bbva.com",17:"becas_morelos.mx@bbva.com",18:"becas_nayarit.mx@bbva.com",19:"becas_nuevol.mx@bbva.com",20:"becas_oaxaca.mx@bbva.com",21:"becas_puebla.mx@bbva.com",22:"becas_queretaro.mx@bbva.com",23:"becas_quintanaroo.mx@bbva.com",24:"becas_slp.mx@bbva.com",25:"becas_sinaloa.mx@bbva.com",26:"becas_sonora.mx@bbva.com",27:"becas_tabasco.mx@bbva.com",28:"becas_tamaulipas.mx@bbva.com",29:"becas_tlaxcala.mx@bbva.com",30:"becas_veracruz.mx@bbva.com",31:"becas_yucatan.mx@bbva.com",32:"becas_zacatecas.mx@bbva.com"},genders=[{id:"0",description:"Hombre"},{id:"1",description:"Mujer"}],schools=[],catalogs={},moduleInitData={},contact={phone:"",email:""};console.log("%cRealizar alguna modificación en esta sección puede provocar la pérdida de tu información\n","color:#a90c0c;font-size:22px;");var servOrigin=window.location.origin,isLocal=-1!=servOrigin.indexOf("localhost");function redirectToLogin(){var e=window.location.origin;-1==e.indexOf("localhost")&&(-1!=e.indexOf("150.250.238.172")?window.location=e+"/mgbfprv_des_mx_web/mgbf_mult_web_fundacionbancomerextranetwebfront_01/":-1!=e.indexOf("150.250.238.173")?window.location=e+"/mgbfprv_test_mx_web/mgbf_mult_web_fundacionbancomerextranetwebfront_01/":-1!=e.indexOf("becasfmxt.mex.igrupobbva")?window.location=e+"/mgbfprv_test_mx_web/mgbf_mult_web_fundacionbancomerextranetwebfront_01/":-1!=e.indexOf("calplataformabecas.fundacionbbvabancomer.com.mx")?window.location=e+"/mgbfprv_qa_mx_web/mgbf_mult_web_fundacionbancomerextranetwebfront_01/":-1!=e.indexOf("plataformabecaslo.fundacionbbvabancomer.org")?window.location=e+"/mgbfprv_lo_mx_web/mgbf_mult_web_fundacionbancomerextranetwebfront_01/":-1!=e.indexOf("plataformabecas.fundacionbbvabancomer.org")?window.location=e+"/mgbfprv_pr_mx_web/mgbf_mult_web_fundacionbancomerextranetwebfront_01/":-1!=e.indexOf("plataformabecas.fundacionbbva.mx")&&(window.location=e+"/mgbfprv_pr_mx_web/mgbf_mult_web_fundacionbancomerextranetwebfront_01/"))}isLocal||(window.oldconsole={},window.oldconsole.log=console.log,console.log=function(){},window.console.log=console.log);var countSession,minutes,timer,_timer,_minutes,_seconds,showLogOut=function(e){e?loadTemplate($("#modal_generic .body"),miniTemplates.success,{title:e,message:"",onAccept:function(){location.reload()}}):loadTemplate($("#modal_generic .body"),miniTemplates.error,{title:"Error",message:"Tu sesión ha terminado por inactividad",onAccept:function(){location.reload()}})},initCountSession=function(){stopCountSession(),timer=minutes=8,countSession=setInterval(function(){console.log("## timer",timer),0==--timer&&(showTimeSession(),stopCountSession())},6e4)},stopCountSession=function(){null!=countSession&&clearInterval(countSession)},refreshSession=function(){$("#modal_timeout").removeAttr("open"),$("#modal_timeout").find(".btn_acept span").text("Continuar con sesión"),showWait(),$.ajax({type:"GET",contentType:"image/png",url:"images/favicons/16x16.png",cache:!1,async:!0,success:function(e){if(initCountSession(),void 0!==e&&-1!=e.indexOf("<title>Login</title>"))return hideWait(),void redirectToLogin();hideWait()},error:function(){hideWait(),redirectToLogin()}})},showTimeSession=function(){var e,a,t=60,i=setInterval(function(){e=parseInt(t/60,10),a=parseInt(t%60,10),e=e<10?"0"+e:e,a=a<10?"0"+a:a,$("#cdSession").text(e+":"+a),--t<0&&($("#modal_timeout").find(".btn_acept span").text("Continuar"),clearInterval(i))},1e3);console.info("## showTimeSession"),$("#modal_timeout").attr("open","")};$("#modal_timeout").find(".btn_acept").click(refreshSession);var logout=function(){showWait(),setTimeout(function(){restExec({service:"TERMINATE_SESSION",async:!1,data:{},success:function(e){console.log("se cerró sesión en back end")},error:function(e){console.log("no se cerró sesión en back end")}}),$.ajax({type:"GET",dataType:"html",url:window.location.origin+"/pkmslogout.form",async:!0,success:function(){redirectToLogin()},error:function(){redirectToLogin()}})},400)};function showWait(){$("body").addClass("loading")}function hideWait(){$("body").removeClass("loading")}var callbackCloseModal=function(){};function formatMoney(e,a){e=(e+="").replace(/,/g,"").replace(/\$/g,"");var t=isNaN(t=Math.abs(t))?2:t,i=e<0?"-":"",o=String(parseInt(e=Math.abs(Number(e)||0).toFixed(t))),s=3<(s=o.length)?s%3:0;return i+(a?"":"$ ")+(s?o.substr(0,s)+",":"")+o.substr(s).replace(/(\d{3})(?=\d)/g,"$1,")+(t?"."+Math.abs(e-o).toFixed(t).slice(2):"")}var verifyCatalogs={catToVerify:[],catIndex:-1,callback:function(){},loopCatalogs:function(){verifyCatalogs.catIndex++,verifyCatalogs.catIndex<verifyCatalogs.catToVerify.length?(showWait(),"STATES"==verifyCatalogs.catToVerify[verifyCatalogs.catIndex]?loadModule.getStates():loadModule.getCatalog(verifyCatalogs.catToVerify[verifyCatalogs.catIndex],verifyCatalogs.loopCatalogs)):(verifyCatalogs.catToVerify=[],verifyCatalogs.catIndex=-1,verifyCatalogs.callback(),verifyCatalogs.callback=function(){},hideWait())}},fn_verifyCatalogs=function(e,a){verifyCatalogs.catToVerify=e,verifyCatalogs.callback=a,verifyCatalogs.loopCatalogs()};function fillHelpSticky(){var e={placement:"left",trigger:"click",html:!0,closeOnClickOutside:!0,title:"",tooltiptitle:{contactPhone:contact.phonetext,contactEmail:contact.email}};isMobile.any()&&($("body").addClass("mobile"),$(".fig-username").find(".username").remove(),$(".btn-menu").find(".action-exit").remove(),btn,exit,e.placement="top",e.tooltiptitle.contactPhone='<a href="tel:+52'+contact.phone+'">'+contact.phonetext+"</a>",e.tooltiptitle.contactEmail='<a href="mailto:'+contact.email+'">'+contact.email+"</a>"),new Tooltip($("#call_h"),e).updateTitleContent('<div class="tooltip_title">Llámanos</div><div class="tooltip_message">Será un placer atenderte por télefono,<b> de lunes a viernes </b>de <b>9 </b> a <b>18 h</b> en el:</div><div class="tooltip_contact">'+e.tooltiptitle.contactPhone+'</div><div class="tooltip_message">Tiempo medio de espera:<br><b>5 minutos</b></div>'),new Tooltip($("#email_h"),e).updateTitleContent('<div class="tooltip_title">Escríbenos</div><div class="tooltip_message">Será un placer atenderte por correo</div><div class="tooltip_contact">'+e.tooltiptitle.contactEmail+'</div><div class="tooltip_message">Tiempo medio de espera:<br><b>24 horas</b></div>'),(helpScoolTooltip=new Tooltip($("#help_sh"),e)).updateTitleContent('<div class="tooltip_title">¿Te podemos ayudar?</div><div class="tooltip_message">Hemos detectado que no encuentras tu escuela</div><div class="btn_ht"><span title="Sí" aria-label="Sí" class="btn__basic btn__small" id="st_btn_reportschool"><span aria-hidden="true">Sí</span></span></div><div class="btn_ht"><span title="No" aria-label="No" class="btn__basic btn__small" id="st_btn_cancel"><span aria-hidden="true">No</span></span></div>'),helpSticky()}function helpSticky(){$(".btn_help").click(function(e){e.preventDefault(),$(this).hasClass("active")?$(this).removeClass("active"):($(".btn_help").not("id",$(this).attr("id")).removeClass("active"),$(this).addClass("active"))}),$(".page-container").click(function(){$(".btn_help").hasClass("active")&&($(".btn_help").removeClass("active"),helpScoolTooltip.hide())})}function concatSpace(e,a){return(e=e.toUpperCase().replace(/Á/gi,"A").replace(/É/gi,"E").replace(/Í/gi,"I").replace(/Ó/gi,"O").replace(/Ú/gi,"U")).concat(" ".repeat(a-e.length))}function validateEmptyOption(e){_tmpOpts=e.data("options")||[],_hasEmptyOp=!1;for(var a=0;a<_tmpOpts.length;a++)if(0==_tmpOpts[a].id||"0"==_tmpOpts[a].id){_hasEmptyOp=!0;break}_hasEmptyOp||(_descSt=dommySchools.getDommyDescription(),_tmpOpts.push({id:0,description:_descSt}),e.comboSelect(_tmpOpts)),e.data("selected",{id:0,description:_descSt}),e.removeComboError(),e.find(".option-text").removeClass("center"),e.find(".selected-option").text(_descSt)}var navbar=document.getElementsByClassName("header");function _get_window_height(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0}function _get_window_Yscroll(){return window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop||0}function _get_doc_height(){return Math.max(document.body.scrollHeight||0,document.documentElement.scrollHeight||0,document.body.offsetHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0,document.documentElement.clientHeight||0)}function _get_scroll_percentage(){return(_get_window_Yscroll()+_get_window_height())/_get_doc_height()*100}var LIST_SERVICES={services:[],errors:[],callback:function(){},inProgress:!(window.onscroll=function(){0<window.pageYOffset?_get_scroll_percentage()<80&&navbar[0].classList.add("sticky"):navbar[0].classList.remove("sticky")}),listRestExec:function(e,a){e.ignoreError=e.ignoreError||!1,LIST_SERVICES.services.push(e),"function"==typeof a&&(LIST_SERVICES.callback=a),LIST_SERVICES.verifyServices()},verifyServices:function(){LIST_SERVICES.inProgress||(LIST_SERVICES.inProgress=!0,showWait(),LIST_SERVICES.loopServices())},loopServices:function(){LIST_SERVICES.services.length?(_restToExe=LIST_SERVICES.services[0],_restToExe.showWait=!1,_restToExe.async=!0,_restToExe.error=_restToExe.error||rest_fnNothig,void 0===_restToExe.finallyError?_restToExe.finallyError=[]:"function"==typeof _restToExe.finallyError&&(_restToExe.finallyError=[_restToExe.finallyError]),void 0===_restToExe.finallySuccess?_restToExe.finallySuccess=[]:"function"==typeof _restToExe.finallySuccess&&(_restToExe.finallySuccess=[_restToExe.finallySuccess]),_restToExe.ignoreError||_restToExe.finallyError.push(function(e){LIST_SERVICES.errors.push(e)}),_fnLoop=function(){LIST_SERVICES.services.shift(),LIST_SERVICES.loopServices()},_restToExe.finallySuccess.push(_fnLoop),_restToExe.finallyError.push(_fnLoop),restExec(_restToExe)):(LIST_SERVICES.errors.length&&(loadTemplate($("#modal_generic .body"),miniTemplates.error,{title:"Se presentaron algunos errores al realizar operación",message:"Es posible que tu información no se muestre de forma completa"}),LIST_SERVICES.errors=[]),hideWait(),LIST_SERVICES.inProgress=!1,LIST_SERVICES.callback())}};function restExec(e){var t={type:e.type||"POST",service:e.service,headers:e.headers||{},data:e.data||{},async:e.async||!0,success:e.success||rest_fnNothig,error:e.error||rest_fnShowError,showWait:e.showWait||!1,finallySuccess:e.finallySuccess||rest_fnNothig,finallyError:e.finallyError||rest_fnNothig,hasUrlParam:e.hasUrlParam||!1,urlParam:e.urlParam||{}};console.log("datos a enviar: ",t.data),console.log("string ",JSON.stringify(t.data)),rest_execute=function(){$.ajax({type:t.type,dataType:"json",contentType:"application/json; charset=utf-8",url:SCONFIG.get(t),data:JSON.stringify(t.data),async:t.async,cache:!1,success:function(a){initCountSession(),console.log("RESPUESTA "+t.service,a),t.showWait&&hideWait(),t.success(a),t.finallySuccess.constructor===Array?t.finallySuccess.forEach(function(e){e(a)}):t.finallySuccess(a)},error:function(a){if(initCountSession(),console.log("ERROR EN SERVICIO "+t.service,a),void 0!==a.responseText&&-1!=a.responseText.indexOf("<title>Login</title>"))return showLogOut(),void hideWait();void 0!==a.responseJSON&&(a.responseJSON.code=a.responseJSON.code||a.responseJSON.errorcode,a.responseJSON.message=a.responseJSON.message||a.responseJSON.errormessage),t.showWait&&hideWait(),t.error(a),t.finallyError.constructor===Array?t.finallyError.forEach(function(e){e(a)}):t.finallyError(a)}})},t.showWait&&showWait(),rest_execute()}var rest_fnNothig=function(){console.log("nothing")},rest_fnShowError=function(e){void 0!==e.responseJSON&&void 0!==e.responseJSON.message||(e.responseJSON={message:"SIN DETALLE DEL ERROR"}),loadTemplate($("#modal_generic .body"),miniTemplates.error,{title:"Ocurrió un error al realizar la operación",message:e.responseJSON.message,redirectToLogin:"No tienes privilegios para accesar"==e.responseJSON.message})},rest_fnGetScholarInf=function(e){moduleInitData.schoolData=e,"1"==__.get(e,"operation.moduleStatus","0")&&changeModuleSatus($("#schoolar-data"),"complete"),"true"==$('[data-target="schoolar-data"]').attr("data-loaded")?(dommySchools.isDommy(__.get(e,"operation.keyWorkplace",""))&&(validateEmptyOption($("#state_s")),validateEmptyOption($("#municipalities_s"))),0!=__.get(e,"schooling.location.state.id","")&&"0"!=__.get(e,"schooling.location.state.id","")||(_prId=moduleInitData.announcement.scholarshipProgram.id,municipalityTransactions[0]=[{id:0,description:dommySchools.getDommyDescription()}]),loadModule.getMunicipalities(__.get(e,"schooling.location.state.id",0),function(){e=moduleInitData.schoolData,$("#municipalities_s").comboSelect(municipalityTransactions[__.get(e,"schooling.location.state.id","")]),fillForm($("#formschdata"),{promgen:__.get(e,"average",""),state_s:__.get(e,"schooling.location.state.id",""),municipalities_s:__.get(e,"schooling.location.municipality.id",""),search_by:"CCT",cct:__.get(e,"operation.keyWorkplace",""),turn:__.get(e,"schooling.profession.scholarShift.id",""),career_area:__.get(e,"schooling.profession.area.id",""),career_subarea:__.get(e,"schooling.profession.subArea.id",""),program_career:__.get(e,"schooling.profession.careerName",""),type_s:__.get(e,"schooling.profession.type.id",""),duration:__.get(e,"schooling.profession.duration.id",""),trans:""!=__.get(e,"expenses.transportationAmount","")?formatMoney(__.get(e,"expenses.transportationAmount","")):"",dsclass:__.get(e,"schooling.profession.classesStartDate","--").split("/")[0],msclass:__.get(e,"schooling.profession.classesStartDate","--").split("/")[1],ysclass:__.get(e,"schooling.profession.classesStartDate","--").split("/")[2],change_h:"true"==__.get(e,"changeAddress","").toString()?"SI":"false"==__.get(e,"changeAddress","").toString()?"NO":""}),$("#modality").selectOptionDescription(__.get(e,"schooling.profession.modality.description","")),"true"==__.get(e,"changeAddress","").toString()&&fillForm($("#formschdata"),{state_m:__.get(e,"schooling.newLocation.state.id",""),municipalities_m:__.get(e,"schooling.newLocation.municipality.id",""),rent:"true"==__.get(e,"expenses.isPayRent","").toString()?"SI":"false"==__.get(e,"expenses.isPayRent","").toString()?"NO":""}),"true"==__.get(e,"expenses.isPayRent","").toString()&&fillForm($("#formschdata"),{payment_rent:""!=__.get(e,"expenses.mounthlyRent","")?formatMoney(__.get(e,"expenses.mounthlyRent","")):""}),""!=__.get(e,"operation.keyWorkplace","")&&($("#schoolslist").searchList({filterid:"keyWorkplace",filtertext:"schoolOficialName",items:[{keyWorkplace:__.get(e,"operation.keyWorkplace",""),schoolOficialName:__.get(e,"schooling.schoolName","")}]}),$("#schoolslist").selectFromList(__.get(e,"operation.keyWorkplace",""))),dommySchools.isDommy(__.get(e,"operation.keyWorkplace",""))&&($("#search_by .radio-buttons").addClass("disabled"),$("input#cct").prop("disabled",!0)),seedFindSchool&&(clearTimeout(seedFindSchool),seedFindSchool=void 0)})):LIST_SERVICES.listRestExec({showWait:!0,service:"GET_MUNICIPALITY",type:"POST",asyn:!1,data:{state:__.get(moduleInitData.schoolData,"schooling.location.state.id",0)},finallySuccess:[function(e){rest_fnGetMunicipalities(__.get(moduleInitData.schoolData,"schooling.location.state.id",0),e)}],finallyError:[function(e){rest_fnGetMunicipalities(__.get(moduleInitData.schoolData,"schooling.location.state.id",0),e)}]})},rest_fnGetSocialData=function(e){for(e.relatedPersons=__.get(e,"relatedPersons",[]),i=0;i<e.relatedPersons.length;i++)"1"==e.relatedPersons[i].relationship.id&&(_famAlumno=e.relatedPersons[i],e.relatedPersons.splice(i,1),e.relatedPersons.splice(0,0,_famAlumno));for(moduleInitData.sociodemographic=e,_famMembers=__.get(e,"relatedPersons",[]),family.fromhome.members=[],family.awayfromhome.members=[],family.bbva.member={},i=0;i<_famMembers.length;i++){var a=_famMembers[i];switch(__.get(a,"personDetail.personType","")){case"PERSONS_LIVE_HOME":family.fromhome.members.push({alreadyExists:"true",familyBoss:!0===__.get(a,"personDetail.isHeadOfHousehold","")?"Sí":"No",statusRelated:__.get(a,"statusRelatedPersonsInformation","OK"),relatedid:__.get(a,"id",""),fam_name:__.get(a,"name",""),fam_appat:__.get(a,"lastName",""),fam_apmat:__.get(a,"secondLastName",""),fam_o_relationship:__.get(a,"relationship.otherRelationshipDescription",""),fam_age:__.get(a,"personDetail.age","0"),fam_omedic:__.get(a,"personDetail.healthCareEntity.otherHealthCareEntity",""),total_f:formatMoney(__.get(a,"personDetail.incomes[0].amount",0),!0),sprogramname:__.get(a,"personDetail.otherGovernmentScholarship.otherScholarshipProgramDescription",""),total_sf:formatMoney(__.get(a,"personDetail.otherGovernmentScholarship.incomes[0].amount",0),!0),fam_relationship:{id:__.get(a,"relationship.id",""),description:__.get(a,"relationship.description","")},fam_relationship_des:"10"!=__.get(a,"relationship.id","")?__.get(a,"relationship.description",""):__.get(a,"relationship.otherRelationshipDescription",""),fam_civil:{id:__.get(a,"personDetail.maritalStatus.id",""),description:__.get(a,"personDetail.maritalStatus.description","")},fam_schoollevel:{id:__.get(a,"personDetail.education.id",""),description:__.get(a,"personDetail.education.description","")},fam_medic:{id:__.get(a,"personDetail.healthCareEntity.id",""),description:__.get(a,"personDetail.healthCareEntity.description","")},fam_ocupation:{id:__.get(a,"personDetail.economicActivity.id",""),description:__.get(a,"personDetail.economicActivity.description","")},fam_kindschoolarship:{id:__.get(a,"personDetail.otherGovernmentScholarship.otherGovernmentScholarshipType.id",""),description:__.get(a,"personDetail.otherGovernmentScholarship.otherGovernmentScholarshipType.description","")},fam_programschoolarship:{id:__.get(a,"personDetail.otherGovernmentScholarship.id",""),description:__.get(a,"personDetail.otherGovernmentScholarship.description","")},fam_gender:{id:__.get(a,"personDetail.gender.id",""),description:__.get(a,"personDetail.gender.id","")},fam_studing:{id:__.get(a,"personDetail.isStudent",""),description:1==__.get(a,"personDetail.isStudent","")?"Sí":"No"},fam_worked:{id:__.get(a,"personDetail.hasWorkedLastMonth","").toString(),description:!0===__.get(a,"personDetail.hasWorkedLastMonth","")?"Sí":"No"},fam_otherschoolarship:{id:""==__.get(a,"personDetail.otherGovernmentScholarship.id","")?"1":"0",description:""==__.get(a,"personDetail.otherGovernmentScholarship.id","")?"No":"Sí"},m_checkfirstname:"XXXXX"==__.get(a,"lastName",""),m_checklastname:"XXXXX"==__.get(a,"secondLastName","")}),c_fam=family.fromhome.members[family.fromhome.members.length-1],"0"==c_fam.fam_otherschoolarship.id&&(c_fam.infoscolarship='{"tipo":"'+__.get(a,"personDetail.otherGovernmentScholarship.otherGovernmentScholarshipType.description","")+'","programa": "'+__.get(a,"personDetail.otherGovernmentScholarship.description","")+'","monto": "'+formatMoney(__.get(a,"personDetail.otherGovernmentScholarship.incomes[0].amount",0),!0)+'"}');break;case"NOT_LIVE_HOME_ECONOMIC_SUPPORT":family.awayfromhome.members.push({alreadyExists:"true",statusRelated:__.get(a,"statusRelatedPersonsInformation","OK"),relatedid:__.get(a,"id",""),fam_name:__.get(a,"name",""),fam_appat:__.get(a,"lastName",""),fam_apmat:__.get(a,"secondLastName",""),fam_o_relationship:__.get(a,"relationship.otherRelationshipDescription",""),total_f:formatMoney(__.get(a,"personDetail.incomes[0].amount",0),!0),fam_relationship:{id:__.get(a,"relationship.id",""),description:__.get(a,"relationship.description","")},fam_relationship_des:"10"!=__.get(a,"relationship.id","")?__.get(a,"relationship.description",""):__.get(a,"relationship.otherRelationshipDescription",""),fam_lives:{id:__.get(a,"personDetail.residencePlace.id",""),description:__.get(a,"personDetail.residencePlace.description","")},fam_ocupation:{id:__.get(a,"personDetail.economicActivity.id",""),description:__.get(a,"personDetail.economicActivity.description","")},m_checkfirstname:"XXXXX"==__.get(a,"lastName",""),m_checklastname:"XXXXX"==__.get(a,"secondLastName","")});break;case"RELATIVE_WORKS_BBVA":family.bbva.member={alreadyExists:"true",statusRelated:__.get(a,"statusRelatedPersonsInformation","OK"),relatedid:__.get(a,"id",""),name_fbbva:__.get(a,"name",""),lastname_fbbva:__.get(a,"lastName",""),slastname_fbbva:__.get(a,"secondLastName",""),relationship_b_o:__.get(a,"relationship.otherRelationshipDescription",""),workposition_fbbva:__.get(a,"personDetail.professionPosition",""),workstation_fbbva:__.get(a,"personDetail.managementUnit",""),relationship:{id:__.get(a,"relationship.id",""),description:""==__.get(a,"relationship.otherRelationshipDescription","")?__.get(a,"relationship.description",""):__.get(a,"relationship.otherRelationshipDescription","")},relationship_b:{id:__.get(a,"relationship.id",""),description:__.get(a,"relationship.description","")},checkfirstname_fbbva:"XXXXX"==__.get(a,"lastName",""),checklastname_fbbva:"XXXXX"==__.get(a,"secondLastName","")}}}for(var t in family.unregistered=!1,family.fromhome.total=family.fromhome.members.length,$("#n_family").selectOptionId(family.fromhome.members.length),$("#nfamilylist").empty(),family.fromhome.members)family.fromhome.members[t].memberid=t,"Delete"!=family.fromhome.members[t].statusRelated&&loadTemplate($("#nfamilylist"),miniTemplates.familymembercard,family.fromhome.members[t],"append");for(var o in family.awayfromhome.total=family.awayfromhome.members.length,$("#nextrafamilylist").empty(),family.awayfromhome.members)family.awayfromhome.members[o].memberid=o,"Delete"!=family.awayfromhome.members[o].statusRelated&&loadTemplate($("#nextrafamilylist"),miniTemplates.efamilymembercard,family.awayfromhome.members[o],"append");$("#extrafamily").selectOptionId(family.awayfromhome.members.length),$("#fam_bbvacard").empty(),0!=Object.keys(family.bbva.member).length?($("#bbvafamily").selectRadioId("0"),loadTemplate($("#fam_bbvacard"),miniTemplates.familybbvacard,family.bbva.member),family.bbva.member&&$("#bbva_employee").prev(".notification.error").length&&$("#bbva_employee").prev(".notification.error").slideUp("slow")):$("#bbvafamily").selectRadioId("1"),"COMPLETE"==__.get(e,"auditInformation.moduleStatus","")&&changeModuleSatus($("#social-data"),"complete")},rest_fnGetHomeServices=function(e){moduleInitData.home=e,"1"==__.get(e,"operation.moduleStatus","0")&&changeModuleSatus($("#home-data"),"complete"),"true"==$('[data-target="home-data"]').attr("data-loaded")&&(_hasInt=__.get(e,"homeInformation.belongings.hasInternet",""),_hasCom=__.get(e,"homeInformation.belongings.hasComputer",""),_hasWas=__.get(e,"homeInformation.belongings.hasWashingMachine",""),_hasMic=__.get(e,"homeInformation.belongings.hasMicrowave",""),_hasPay=__.get(e,"homeInformation.belongings.hasPayTV",""),_hasMot=__.get(e,"homeInformation.belongings.hasMotorcycle",""),fillForm($("#formhdata"),{roomsNumber:__.get(e,"homeInformation.roomsNumber",""),bedroomsNumber:__.get(e,"homeInformation.bedroomsNumber",""),bathroomsNumber:__.get(e,"homeInformation.bathroomsNumber",""),waterServicesType:__.get(e,"homeInformation.homeService.waterServicesType.id",""),drainageType:__.get(e,"homeInformation.drainageType.id",""),lightServicesType:__.get(e,"homeInformation.homeService.lightServicesType.id",""),cookingFuelType:__.get(e,"homeInformation.cookingFuelType.id",""),wallMaterialsType:__.get(e,"homeInformation.wallMaterialsType.id",""),ceilingMaterialsType:__.get(e,"homeInformation.ceilingMaterialsType.id",""),floorMaterialsType:__.get(e,"homeInformation.floorMaterialsType.id",""),carsNumber:__.get(e,"homeInformation.belongings.carsNumber",""),hasInternet:1==_hasInt?"SI":0==_hasInt?"NO":"",hasComputer:1==_hasCom?"SI":0==_hasCom?"NO":"",hasWashingMachine:1==_hasWas?"SI":0==_hasWas?"NO":"",hasMicrowave:1==_hasMic?"SI":0==_hasMic?"NO":"",hasPayTV:1==_hasPay?"SI":0==_hasPay?"NO":"",hasMotorcycle:1==_hasMot?"SI":0==_hasMot?"NO":""}))},rest_fnGetLegalDisclaimers=function(e){moduleInitData.legalDisclaimer=e;var a=__.get(e,"legalDisclaimers",[]),t="";for(i=0;i<a.length;i++)$("#legal"+(i+1)).attr("data-legal-id",a[i].id),$("#legal"+(i+1)).attr("data-legal-consecutive",a[i].consecutive),t=a[i].description.split("|"),$("#legaltext"+(i+1)).text(t[0]),$("#legallink"+(i+1)).text(t[1]),$("#legallink"+(i+1)).attr("href",a[i].link),"Y"==__.get(e,"legalDisclaimers["+i+"].isAccepted","N")?$("#legal"+(i+1)).doCheck():$("#legal"+(i+1)).unCheck();"COMPLETO"==__.get(e,"validation.status","")?(changeModuleSatus($("#legal-data"),"complete"),$("#legal1, #legal2, #legal3").addClass("disabled"),$("#btn_saveld").addClass("btn__disabled")):(changeModuleSatus($("#legal-data"),"incomplete"),$("#legal1, #legal2, #legal3").removeClass("disabled"),$("#btn_saveld").removeClass("btn__disabled")),0<a.length&&$("#formldata").show()},rest_fnGetScholarshipAnnouncement=function(e){scholarshipAnnouncement=e,moduleInitData.announcement=scholarshipAnnouncement,$("#scholarshipProgram").text(),contact.phone=__.get(scholarshipAnnouncement,"phoneNumber",""),contact.phonetext=contact.phone,12==contact.phone.length&&(contact.phonetext="("+contact.phone.substr(0,2)+" "+contact.phone.substr(2,3)+") "+contact.phone.substr(5,3)+" "+contact.phone.substr(8)),contact.email=__.get(scholarshipAnnouncement,"email",""),fillHelpSticky(),_progId=__.get(scholarshipAnnouncement,"scholarshipProgram.id",""),$("#scholarshipProgram").text("1"==_progId?"Secundaria":"2"==_progId?"Preparatoria":"7"==_progId?"Universidad":""),"1"==scholarshipAnnouncement.globalStatus&&($(".step-container").find(".btn__submit").addClass("btn__disabled"),$(".submtbtn.send").attr("style","display: none"));switch(moduleInitData.announcement.scholarshipProgram.id){case"1":$(".typeuni").remove(),$(".typeprep").remove(),$("#promgen").siblings(".placeholder-simulator").text("Promedio general de primaria"),$("#lastLevel").text("primaria"),$("#nextLevel").text("secundaria"),"<div>¿Cómo calcular el promedio? <br> 6to año de primaria (1er trimestre + 2do trimestre) <hr> El resultado divídelo entre 2</div>";break;case"2":$(".typeuni").remove(),$("#promgen").siblings(".placeholder-simulator").text("Promedio general de secundaria"),$("#lastLevel").text("secundaria"),$("#nextLevel").text("preparatoria"),"<div>¿Cómo calcular el promedio? <ul style='text-align:left'><li> &nbsp; &nbsp; 1er año de secundaria</li><li>+ 2do año de secundaria</li><li>+ 3er año de secundaria (1er trimestre + 2do trimestre)</li></ul><hr> El resultado divídelo entre 3</div>";break;case"7":$("#promgen").siblings(".placeholder-simulator").text("Promedio general de preparatoria"),$("#lastLevel").text("preparatoria"),$("#nextLevel").text("universidad"),"<div>¿Cómo calcular el promedio? <ul style='text-align:center'> <li> &nbsp; &nbsp; 1er semestre</li><li>+ 2do semestre</li><li>+ 3er semestre</li><li>+ 4to semestre</li><li>+ 5to semestre</li> </ul><hr> El resultado divídelo entre 5</div>"}loadMainModules()},rest_fnUpdateScholarshipAnnouncementStatus=function(){_dateArray=moduleInitData.general.currentDate.split("-");var a="";month.find(function(e){e.id!=_dateArray[1]||(a=_dateArray[0]+" DE "+e.monthcomplete+" DE "+_dateArray[2])}),restExec({service:"SEND_NOTIFICATION",data:{eventCode:"0000001844",senderId:"0000000001",devices:[{id:"102",serviceProvider:{id:"@@@"},receivers:[moduleInitData.general.student[0].contactInf[0].email]}],message:{messageBody:concatSpace(a,25)+concatSpace(moduleInitData.general.student[0].name,50)+concatSpace(moduleInitData.general.student[0].firstName,50)+concatSpace(moduleInitData.general.student[0].lastName,50)}},success:function(){loadTemplate($("#modal_generic .body"),miniTemplates.success,{title:"¡Gracias!",message:"Has finalizado la primera parte del registro. Te enviaremos por correo electrónico los pasos que deberás seguir.",onAccept:loadModule.scholarshipAnnouncement})},showWait:!0})},rest_fnGetSchoolCatalog=function(e,a){if(-1!=e.indexOf("CAT_PARENTESCO"))for(i=0;i<a.data.length;i++)if("0"==a.data[i].id){a.data.splice(i,1);break}if("CAT_PARENTESCO-Tutor"==e){for(i=0;i<a.data.length;i++)if("25"==a.data[i].id){_parOther=a.data[i],a.data.splice(i,1),a.data.push(_parOther);break}}else if("CAT_PARENTESCO-Miembro"==e){for(i=0;i<a.data.length;i++)if("10"==a.data[i].id){_parOther=a.data[i],a.data.splice(i,1),a.data.push(_parOther);break}}else if("CAT_PARENTESCO-Soporte"==e){for(i=0;i<a.data.length;i++)if("19"==a.data[i].id){_parOther=a.data[i],a.data.splice(i,1),a.data.push(_parOther);break}}else if(0==e.indexOf("CAT_TPO_ESCUELA-")){for(i=0;i<a.data.length;i++)a.data[i].id=i;a.data.sort(function(e,a){return _descA=e.description.toUpperCase(),_descB=a.description.toUpperCase(),_comparison=0,_descA>_descB?comparison=1:_descA<_descB&&(comparison=-1),comparison})}else if(0==e.indexOf("CAT_OCUPACION"))for(i=0;i<a.data.length;i++)if("10"==a.data[i].id){a.data.splice(i,1);break}catalogs[e]=a.data||[]},rest_fnListSchools=function(e){e=e.school||[],schools=schools.concat(e)},rest_fnGetStates=function(e){stateTransactions=__.get(e,"stateTransactions",[]);var a=[];for(i=0;i<stateTransactions.length;i++)a.push({id:stateTransactions[i].state.code,description:stateTransactions[i].state.name});stateTransactions=a},rest_fnGetMunicipalities=function(e,a){var t=__.get(a,"municipalityTransactions",[]),o=[];for(i=0;i<t.length;i++)o.push({id:t[i].municipality.code,description:t[i].municipality.name});municipalityTransactions[e]=o||[]},rest_fnGetGeneralDataFun=function(e){dataStudent=e.student[0],"NUEVO"==e.moduleStatus?loadTemplate($("#modal_generic .body"),templates.confirmemail,{c_email:dataStudent.contactInf[0].email}):"ERROR"==e.moduleStatus?loadTemplate($("#modal_generic .body"),miniTemplates.error,{title:"Aún no puedes participar en la convocatoria",message:"Podrás participar en la convocatoria cuando estés por finalizar el último grado",redirectToLogin:!0}):loadModule.scholarshipAnnouncement()},validateGeneralStatus=function(){"COMPLETO"==__.get(moduleInitData.general,"moduleStatus","")?($(".page-container .i-form.accordion").not("#wf0").show(),firstModuleComplete?loadModule.legalDisclaimer(function(){loadModule.checkStatus(),changeModuleSatus($("#general-data"),"complete")}):(firstModuleComplete=!0,loadNextModules(function(){loadModule.checkStatus(),changeModuleSatus($("#general-data"),"complete")}))):$(".page-container .i-form.accordion").not("#wf0").hide()},rest_fnGetGeneralData=function(e){if("01-01-1900"==__.get(e,"student[0].scholarBirthdate","--")&&(e.student[0].scholarBirthdate="--"),"00000"==__.get(e,"student[0].domicile[0].codePostal","")&&(e.student[0].domicile[0].codePostal=""),moduleInitData.general=e,"true"!=$('[data-target="general-data"]').attr("data-loaded"))return LIST_SERVICES.listRestExec({showWait:!0,service:"GET_MUNICIPALITY",type:"POST",asyn:!1,data:{state:__.get(moduleInitData.general,"student[0].domicile[0].cdState",0)},finallySuccess:[function(e){rest_fnGetMunicipalities(__.get(moduleInitData.general,"student[0].domicile[0].cdState",0),e)}],finallyError:[function(e){rest_fnGetMunicipalities(__.get(moduleInitData.general,"student[0].domicile[0].cdState",0),e)}]}),void validateGeneralStatus();loadModule.getMunicipalities(__.get(e,"student[0].domicile[0].cdState",0),function(e){$("#municipalities").comboSelect(e);var a=__.get(moduleInitData.general,"student[0]",{}),t=__.get(moduleInitData.general,"student[0].tutorData[0]",{}),i=__.get(moduleInitData.general,"student[0].domicile[0]",{}),o=__.get(moduleInitData.general,"student[0].contactInf[0]",{});fillForm($("#formgendata"),{tutorname:__.get(t,"tutorName",""),tutorlastname:__.get(t,"firstNameTutor",""),tutorslastname:__.get(t,"lastaNameTutor",""),username:__.get(a,"name",""),firstname:__.get(a,"firstName",""),lastname:__.get(a,"lastName",""),dbirthdate:__.get(a,"scholarBirthdate","--").split("-")[0],mbirthdate:__.get(a,"scholarBirthdate","--").split("-")[1],ybirthdate:__.get(a,"scholarBirthdate","--").split("-")[2],gender:__.get(a,"gender",""),curp:__.get(a,"CURP",""),street:"X"==__.get(i,"street","")?"":__.get(i,"street",""),outdoornum:"X"==__.get(i,"numExterior","")?"":__.get(i,"numExterior",""),interiornum:__.get(i,"numInterior",""),zipcode:__.get(i,"codePostal",""),neighborhood:"X"==__.get(i,"colony","")?"":__.get(i,"colony",""),state:__.get(i,"cdState",""),municipalities:__.get(i,"cdMunicipality",""),references:"X"==__.get(i,"particularReferences","")?"":__.get(i,"particularReferences",""),phone:__.get(o,"homePhone",""),cellphone:__.get(o,"cellPhone",""),errandsphone:__.get(o,"messagePhone",""),email:__.get(o,"email",""),emailconf:__.get(o,"email",""),email2:__.get(o,"email1",""),email2conf:__.get(o,"email1",""),email3:__.get(o,"email2",""),email3conf:__.get(o,"email2","")}),$("#relationship").selectOptionDescription(__.get(t,"kinship","")),$("#o_relationship").setValue(__.get(t,"kinshipType","")),""==__.get(t,"firstNameTutor","")||"XXXXX"==__.get(t,"firstNameTutor","")&&"XXXXX"!=__.get(t,"lastaNameTutor","")?($("#checktutofirstname").doCheck(),$("#checktutofirstname").removeClass("disabled")):($("#checktutofirstname").unCheck(),$("#checktutofirstname").addClass("disabled")),""==__.get(t,"lastaNameTutor","")||"XXXXX"==__.get(t,"lastaNameTutor","")&&"XXXXX"!=__.get(t,"firstNameTutor","")?($("#checktutolastname").doCheck(),$("#checktutolastname").removeClass("disabled")):($("#checktutolastname").unCheck(),$("#checktutolastname").addClass("disabled")),""==__.get(a,"firstName","")||"XXXXX"==__.get(a,"firstName","")&&"XXXXX"!=__.get(a,"lastName","")?($("#checkfirstname").doCheck(),$("#checkfirstname").removeClass("disabled")):($("#checkfirstname").unCheck(),$("#checkfirstname").addClass("disabled")),""==__.get(a,"lastName","")||"XXXXX"==__.get(a,"lastName","")&&"XXXXX"!=__.get(a,"firstName","")?($("#checklastname").doCheck(),$("#checklastname").removeClass("disabled")):($("#checklastname").unCheck(),$("#checklastname").addClass("disabled")),validateGeneralStatus()})},SCONFIG=function(){var t=-1!=window.location.origin.indexOf("localhost:3000")?"http://127.0.0.1:3004/":"/mgbf_mult_web_fundacionbancomerextranetwebfront_01/",i={CONSULT_PARAMETERS:"consult/parameters",SCHOLAR_DETAIL:"details/scholar",MODIF_UPLOADSCHOLAR:"modif/uploadSchoolar",GET_STATES:"list/state",GET_MUNICIPALITY:"list/municipality",TERMINATE_SESSION:"terminate/session",LIST_CATALOGS:"catalogs/{{catalog}}",UPDATE_HOMEINF:"updateHomeInformation/{{scholarId}}",GET_HOMEINF:"getHomeInformation/{{scholarId}}/?programScholarshipId={{programScholarshipId}}",GET_SCHOLARINF:"getScholarInformation/{{scholarId}}/?programScholarshipId={{programScholarshipId}}",UPDATE_SCHOLARINF:"updateScholarInformation",UPDATE_LEGAL:"updateStatusLegalDisclaimer",GET_LEGAL:"listLegalDisclaimers/?scholarshipProgramId={{scholarshipProgramId}}&scholarId={{scholarId}}&moduleId={{moduleId}}",GET_ANNOUNCEMENT:"getScholarshipAnnouncement/?registerType={{registerType}}&scholarId={{scholarId}}",UPDATE_ANNOUNCEMENT:"updateScholarshipAnnouncement",GET_SOCINF:"getSocioeconomicSummary/{{scholarId}}/?programScholarshipId={{scholarshipProgramId}}",CREATE_SOCINF:"createRelatedPersons/{{scholarId}}",UPDATE_SOCINF:"updateRelatedPersons/{{scholarId}}",GET_SCHOOLS:"listSchools",SEND_NOTIFICATION:"sendNotification"};return{get:function(e){var a=t+i[e.service];return e.hasUrlParam?Mustache.render(a,e.urlParam):a}}}(),fn_nothing=function(){},fn_showModal=function(){$("#modal_generic").attr("open","")},fn_hideModal=function(){$("#modal_generic").removeAttr("open")},fn_aceptModal=function(e,a){fn_showModal(),a.redirectToLogin?$(".btn_acept").click(function(e){e.preventDefault(),redirectToLogin()}):"function"==typeof a.onAccept?$(".btn_acept").click(function(){a.onAccept(),fn_hideModal()}):$(".btn_acept").click(function(e){e.preventDefault(),fn_hideModal()})},fn_deleteFam=function(e,a){fn_showModal(),e.find("#btn_delete").click(a.onAccept.bind(a)),e.find("#btn_decline").click(a.onDecline.bind(a)),callbackCloseModal="family"==a.origin?function(){$("#n_family").getOptionSelected().id!=family.fromhome.members.length&&$("#n_family").selectOptionId(family.fromhome.members.length),callbackCloseModal=function(){}}:function(){$("#extrafamily").getOptionSelected().id!=family.awayfromhome.members.length&&$("#extrafamily").selectOptionId(family.awayfromhome.members.length),callbackCloseModal=function(){}}},fn_selectboss=function(e){callbackCloseModal=function(){loadTemplate($("#modal_generic .body"),templates.selectboss,{members:family.fromhome.getMembers()}),fn_showModal()},e.find(".checkbox").ckeckCallback(function(e){$("#formselectboss").find(".checkbox").addClass("disabled"),e.removeClass("disabled")},function(){$("#formselectboss").find(".checkbox").removeClass("disabled")}),e.find("#btn_accept").click(function(){var e=$("#formselectboss").find(".checkbox.checked");function a(e){$("#formselectboss").prev(".notification.error").length&&$("#formselectboss").prev(".notification.error").remove(),loadTemplate($("#formselectboss"),miniTemplates.notification,{type:"error",title:"Lo sentimos",message:e},"before")}if(0==e.length)a("Debes seleccionar a un jefe de familia");else if(1==e.length){var t=Number(e.attr("data-index"));for(var i in family.fromhome.members)family.fromhome.members[i].familyBoss=i==t?"Sí":"No";fn_hideModal(),callbackCloseModal=function(){},$("html").animate({scrollTop:$("#nfamilylist").offset().top-200},1e3,"swing",function(){for(var e in $("#nfamilylist").empty(),family.fromhome.members)void 0===family.fromhome.members[e].fam_worked.id&&(family.fromhome.members[e].fam_worked.id="false",family.fromhome.members[e].fam_worked.description="No"),"Delete"!=family.fromhome.members[e].statusRelated&&loadTemplate($("#nfamilylist"),miniTemplates.familymembercard,family.fromhome.members[e],"append")})}else a("Sólo puedes seleccionar a un jefe del hogar")}),fn_showModal()},fn_confirmModal=function(e,a){a.onDecline="function"==typeof a.onDecline?a.onDecline:fn_hideModal,fn_showModal(),e.find(".btn_acept").click(a.onAccept.bind(a)),e.find(".btn_decline").click(a.onDecline.bind(a))},fn_confirmAllModal=function(e,a){for(a.onDecline="function"==typeof a.onDecline?a.onDecline:fn_hideModal,"7"!=moduleInitData.announcement.scholarshipProgram.id&&e.find(".inidatam").hide(),_familyMembers=jQuery.extend(!0,{},moduleInitData.sociodemographic),_famFromHome=[],_famAwayFromHome=[],_bbvamember={},_i=0;_i<_familyMembers.relatedPersons.length;_i++)_member=_familyMembers.relatedPersons[_i],"PERSONS_LIVE_HOME"==_member.personDetail.personType?_famFromHome.push(_member):"NOT_LIVE_HOME_ECONOMIC_SUPPORT"==_member.personDetail.personType?_famAwayFromHome.push(_member):"RELATIVE_WORKS_BBVA"==_member.personDetail.personType&&(_bbvamember=_member);if(e.find("#n_fromhome").text(_famFromHome.length),_famFromHome.length)for(_i=0;_i<_famFromHome.length;_i++)_famh=_famFromHome[_i],_famh.student=_famh.personDetail.isStudent?"Sí":"No",_famh.hasWorked=_famh.personDetail.hasWorkedLastMonth?"Sí":"No",_famh.otherScholarshipProgramDescription="",(_famh.otherGovernmentScholarshipamount="")!=__.get(_famh,"personDetail.otherGovernmentScholarship.id","")?(_famh.isotherG="Sí",_famh.fam_otherschoolarship="block",_famh.otherScholarshipProgramDescription=_famh.personDetail.otherGovernmentScholarship.description,_famh.otherGovernmentScholarshipamount=formatMoney(_famh.personDetail.otherGovernmentScholarship.incomes[0].amount)):(_famh.isotherG="No",_famh.fam_otherschoolarship="none"),_famh.incomesamount=formatMoney(_famh.personDetail.incomes[0].amount),loadTemplate(e.find("#membersfromhome"),miniTemplates.m_familycard,_famh,"append");else e.find("#membersfromhome").remove();if(e.find("#n_awayhome").text(_famAwayFromHome.length),_famAwayFromHome.length)for(_i=0;_i<_famAwayFromHome.length;_i++)_fam=_famAwayFromHome[_i],_fam.incomesamount=formatMoney(_fam.personDetail.incomes[0].amount),loadTemplate(e.find("#membersawayhome"),miniTemplates.m_efamilycard,_fam,"append");else e.find("#membersawayhome").remove();e.find("#n_bbva").text(Object.keys(_bbvamember).length?"1":"0"),Object.keys(_bbvamember).length?loadTemplate(e.find("#bbvamember"),miniTemplates.m_bbvafamilycard,_bbvamember):e.find("#bbvamember").remove(),fn_showModal(),e.find(".btn_acept").click(a.onAccept.bind(a)),e.find(".btn_decline").click(a.onDecline.bind(a))},fn_confirmemail=function(e){callbackCloseModal=function(){loadTemplate($("#modal_generic .body"),templates.confirmemail,{c_email:dataStudent.contactInf[0].email})},e.find("#econt").data("complete",function(e){e.c_email==e.c_email2?(callbackCloseModal=function(){},fn_hideModal(),restExec({service:"MODIF_UPLOADSCHOLAR",data:{userCurrent:"ALUMNO",registerType:"2",student:[{studentId:"",scholarUser:ivUser.trim(),programType:dataStudent.programKey,statusDispersion:dataStudent.statusDispersion,originRegion:dataStudent.originRegion,schoolCycle:dataStudent.schoolCycle,cdAssignedCR:dataStudent.cdAssignedCR,assignedCR:dataStudent.assignedCR,scholarNumber:dataStudent.scholarNumber,accountNumber:dataStudent.accountNumber,folioPhoto:"",name:dataStudent.name.trim(),firstName:dataStudent.firstName.trim(),lastName:dataStudent.lastName.trim(),CURP:dataStudent.CURP,scholarBirthdate:dataStudent.scholarBirthdate.trim(),gender:dataStudent.gender,schoolData:[{duration:"",turn:"",typeCareer:"",nameCareer:"",area:"",school:[{cdState:"",state:"",cdMunicipality:"",municipality:"",CCT:"",control:"",initials:"",type:"",name:"",domicile:""}]}],domicile:[{street:dataStudent.domicile[0].street.trim(),locality:dataStudent.domicile[0].locality.trim(),numExterior:dataStudent.domicile[0].numExterior.trim(),numInterior:dataStudent.domicile[0].numInterior.trim(),codePostal:dataStudent.domicile[0].codePostal.trim(),cdMunicipality:dataStudent.domicile[0].cdMunicipality.trim(),municipality:dataStudent.domicile[0].municipality.trim(),colony:dataStudent.domicile[0].colony.trim(),cdState:dataStudent.domicile[0].cdState.trim(),state:dataStudent.domicile[0].state.trim(),betweenStreet:dataStudent.domicile[0].betweenStreet.trim(),typeOfRoad1:dataStudent.domicile[0].typeOfRoad1.trim(),andTheStreet:dataStudent.domicile[0].andTheStreet.trim(),typeOfRoad2:dataStudent.domicile[0].typeOfRoad2.trim(),behindStreet:dataStudent.domicile[0].behindStreet.trim(),typeOfRoad3:dataStudent.domicile[0].typeOfRoad3.trim(),particularReferences:dataStudent.domicile[0].particularReferences.trim()}],contactInf:[{homePhone:dataStudent.contactInf[0].homePhone.trim(),cellPhone:dataStudent.contactInf[0].cellPhone.trim(),messagePhone:dataStudent.contactInf[0].messagePhone.trim(),email:e.c_email.trim(),email1:dataStudent.contactInf[0].email1.trim(),email2:dataStudent.contactInf[0].email2.trim(),facebook:""}],tutorData:[{tutorName:dataStudent.tutorData[0].tutorName.trim(),firstNameTutor:dataStudent.tutorData[0].firstNameTutor.trim(),lastNameTutor:dataStudent.tutorData[0].lastaNameTutor.trim(),kinship:dataStudent.tutorData[0].kinship.trim(),kinshipType:dataStudent.tutorData[0].kinshipType.trim()}],program:[{status:"",modalityParticipation:"",generation:"",originResources:"",projectSEPNumber:"",numberNMDP:"",schoolGrade:"",resultImpactEvaluation:""}]}]},showWait:!0,success:function(){loadModule.scholarshipAnnouncement()}})):$("#c_email2").showError("Los correos no coinciden")}),fn_showModal()},fn_reportschool=function(e,a){$(".modal .closemodal").click(function(){$(this).parents(".modal").removeAttr("open")}),$("input.reflectable").each(function(){inpval=$(this).val().trim(),$newinp=$($(this).attr("data-reflecto")),$newinp.val(inpval),""!=$newinp.val()&&$($(this).attr("data-reflecto")).siblings(".placeholder-simulator").attr("style","top: 5px; font-size: 12px;")}),$(".form-group-select.reflectable").each(function(){dataOptions=$(this).data("options"),$reflectTo=$($(this).attr("data-reflecto")),null!=dataOptions&&($reflectTo.reset(),$reflectTo.comboSelect(dataOptions),opSelected=$(this).getOptionSelected(),null!=opSelected&&$reflectTo.selectOptionId(opSelected.id))}),null!=$("#m_state_s").getOptionSelected()&&"0"==$("#m_state_s").getOptionSelected().id&&$("#m_state_s").reset(),null!=$("#m_municipalities_s").getOptionSelected()&&"0"==$("#m_municipalities_s").getOptionSelected().id&&$("#m_municipalities_s").reset(),fn_showModal(),state_id=$("#state_s").getOptionSelected().id,mun_id=$("#municipalities_s").getOptionSelected().id,state_id=$("#state_s").getOptionSelected().id,mun_id=$("#municipalities_s").getOptionSelected().id,loadModule.getCatalog("CAT_TPO_ESCUELA-"+state_id+"-"+mun_id+"-"+moduleInitData.announcement.scholarshipProgram.id,function(){_cat=catalogs["CAT_TPO_ESCUELA-"+state_id+"-"+mun_id+"-"+moduleInitData.announcement.scholarshipProgram.id].slice(0),_cat.push({id:"x",description:"Ninguno de los anteriores"}),fnFillCatalogs("schoolType",_cat,function(){})}),$("#m_state_s").onSelect(function(e){loadModule.getMunicipalities(e.id,function(){$("#m_municipalities_s").reset(),fnFillCatalogs("m_municipalities_s",municipalityTransactions[e.id])})}),$("#schoolform").data("complete",function(e){dateArray=moduleInitData.general.currentDate.split("-");var a="",t="";month.find(function(e){e.id==dateArray[1]&&(a=dateArray[0]+" DE "+e.monthcomplete+" DE "+dateArray[2])}),"1"==moduleInitData.announcement.scholarshipProgram.id?t="SECUNDARIA":"2"==moduleInitData.announcement.scholarshipProgram.id?t="PREPARATORIA":"7"==moduleInitData.announcement.scholarshipProgram.id&&(t="UNIVERSIDAD");var i=[{str:a,size:25},{str:moduleInitData.general.student[0].name,size:50},{str:moduleInitData.general.student[0].firstName,size:50},{str:moduleInitData.general.student[0].lastName,size:50},{str:moduleInitData.general.student[0].domicile[0].state,size:50},{str:moduleInitData.general.student[0].domicile[0].municipality,size:50},{str:moduleInitData.general.student[0].contactInf[0].email,size:100},{str:moduleInitData.general.student[0].contactInf[0].homePhone,size:10},{str:e.m_state_s.description,size:50},{str:e.m_municipalities_s.description,size:50},{str:t,size:50},{str:e.schoolType.description,size:150},{str:e.m_school,size:100}];restExec({service:"SEND_NOTIFICATION",data:{eventCode:"0000001843",senderId:"0000000001",devices:[{id:"102",serviceProvider:{id:"@@@"},receivers:[scholsEmail[e.m_state_s.id]]}],message:{messageBody:function(e){_Tstr="";for(var a=0;a<e.length;a++){var t=e[a];_Tstr+=concatSpace(t.str,t.size)}return _Tstr}(i)}},success:fn_send_no_school,showWait:!0})})},fn_send_no_school=function(e){fn_hideModal(),"PENDING"==e.data.devices[0].status.id?loadTemplate($("#modal_generic .body"),miniTemplates.success,{title:"Información enviada",message:"Hemos recibido tu duda, Te contactaremos en un máximo de 24 horas"}):loadTemplate($("#modal_generic .body"),miniTemplates.error,{title:"Ocurrió un error al realizar operación",message:"Ocurrió un problema, por favor intentalo más tarde"}),validateEmptyOption($("#state_s")),validateEmptyOption($("#municipalities_s")),$("#search_by").selectRadioId("CCT"),$("#schoolname").setValue(dommySchools.getDommyDescription()),$("#schoolslist").searchList({filterid:"keyWorkplace",filtertext:"schoolOficialName",items:[{keyWorkplace:dommySchools.getDommyCCT(),schoolOficialName:dommySchools.getDommyDescription()}]}),$("#schoolslist").selectFromList(dommySchools.getDommyCCT()),$("#cct").setValue(dommySchools.getDommyCCT()),$("#search_by .radio-buttons").addClass("disabled"),$("input#cct").prop("disabled",!0)},fn_familymodal=function(e,a){function t(e){"10"==e.id?($("#fam_o_relationship").clearInput(),$("#fam_o_relationship").attr("required","required"),$("#fam_other_relationship").slideDown()):($("#fam_o_relationship").removeAttr("required"),$("#fam_other_relationship").slideUp())}if(e.find("#total_sf").each(function(){$(this).keyup(function(){var e=$().add($(this));"0.00"===e.val()&&e.showError("La cantidad no puede ser cero")})}),$("#fam_gender").comboSelect(genders),$("#fam_civil").comboSelect(catalogs.CAT_EDO_CIVIL),$("#fam_schoollevel").comboSelect(catalogs.CAT_MAX_NVL_ESTUDIO),fnFillCatalogs("fam_medic",catalogs.CAT_INST_MEDICA,function(e){"7"==e.id?($("#other_medic").slideDown(),$("#fam_omedic").prop("required",!0)):($("#other_medic").slideUp(),$("#fam_omedic").clearInput(),$("#fam_omedic").prop("required",!1))}),$("#fam_ocupation").comboSelect(catalogs.CAT_OCUPACION),$("#fam_age").on("keyup",function(){14<=Number($(this).val())?($("#age14").slideDown("slow"),$("#fam_worked").addClass("required"),$("#fam_worked").clearRadio()):($("#age14").slideUp("slow"),$("#fam_worked").removeClass("required"),$("#fam_worked").selectRadioId("false"))}),$("#fam_otherschoolarship").onChecked(function(e){"0"==e.id?($(".schoolarshiparea").slideDown(),$("#fam_kindschoolarship").addClass("required"),$("#fam_programschoolarship").addClass("required"),$("#total_sf").prop("required",!0)):($(".schoolarshiparea").slideUp(),$("#fam_kindschoolarship").removeClass("required"),$("#fam_programschoolarship").removeClass("required"),$("#fam_programschoolarship").reset(),$("#total_sf").prop("required",!1))}),$("#fam_kindschoolarship").comboSelect(catalogs.CAT_TPO_APOYO),$("#fam_programschoolarship").comboSelect(catalogs.CAT_INST_APOYO,function(e){"6"==e.id?($("#oschoolarship").slideDown(),$("#sprogramname").prop("required",!0)):($("#oschoolarship").slideUp(),$("#sprogramname").prop("required",!1),$("#sprogramname").clearInput())}),_isStudent="edit"==a.flags.type&&0==a.flags.memberid||"1"==family.fromhome.index(),_isStudent)$("#fam_relationship").comboSelect(catalogs["CAT_PARENTESCO-Miembro"],t);else{var o=jQuery.extend(!0,{},{rel:catalogs["CAT_PARENTESCO-Miembro"]});for(i=0;i<o.rel.length;i++)if(element=o.rel[i],"1"==element.id){o.rel.splice(i,1);break}$("#fam_relationship").comboSelect(o.rel,t)}if($("#familyformbtn").data("complete",function(e){e.infoscolarship="",e.total_f=formatMoney(e.total_f,!0),e.total_sf=""==e.total_sf?"":formatMoney(e.total_sf,!0),null!=e.fam_otherschoolarship&&"0"==e.fam_otherschoolarship.id&&(e.infoscolarship='{"tipo":"'+e.fam_kindschoolarship.description+'","programa": "'+e.fam_programschoolarship.description+'","monto": "'+e.total_sf+'"}'),"10"!=e.fam_relationship.id?e.fam_relationship_des=e.fam_relationship.description:e.fam_relationship_des=e.fam_o_relationship,"edit"==e.flag?("true"==e.alreadyExists&&(e.statusRelated="Edit"),family.fromhome.members[e.memberid]=e):(e.statusRelated="Add",family.fromhome.members.push(e)),$("#formfamily").slideUp("slow",function(){if(family.fromhome.index()<=family.fromhome.total)fn_verifyCatalogs(["CAT_INST_MEDICA","CAT_EDO_CIVIL","CAT_OCUPACION","CAT_TPO_APOYO","CAT_INST_APOYO","CAT_PARENTESCO-Miembro","CAT_MAX_NVL_ESTUDIO"],function(){loadTemplate($("#modal_generic .body"),templates.family,family.fromhome)});else{$("#fam_members").prev().hasClass("error")&&$("#fam_members").prev().remove();var e=!1;for(var a in family.fromhome.members)family.fromhome.members[a].memberid=a,"Sí"==family.fromhome.members[a].familyBoss&&(e=!0);"edit"==this.flag||e?($("html").animate({scrollTop:$("#nfamilylist").offset().top-200},1e3,"swing",function(){for(var e in $("#nfamilylist").empty(),family.fromhome.members)"Delete"!=family.fromhome.members[e].statusRelated&&loadTemplate($("#nfamilylist"),miniTemplates.familymembercard,family.fromhome.members[e],"append")}),fn_hideModal()):loadTemplate($("#modal_generic .body"),templates.selectboss,{members:family.fromhome.getMembers()})}}.bind(e))}),"edit"==a.flags.type&&(membertoedit=family[a.flags.group].members[a.flags.memberid],membertoedit.flag="edit",membertoedit.total_f=formatMoney(membertoedit.total_f),membertoedit.total_sf=formatMoney(membertoedit.total_sf),fillForm($("#formfamily"),membertoedit),$("#fam_o_relationship").setValue(membertoedit.fam_o_relationship),"XXXXX"==moduleInitData.general.student[0].firstName&&"XXXXX"!=moduleInitData.general.student[0].lastName&&e.find("#m_checkfirstname").doCheck(),"XXXXX"==moduleInitData.general.student[0].lastName&&"XXXXX"!=moduleInitData.general.student[0].firstName&&e.find("#m_checklastname").doCheck()),_isStudent)switch($("#fam_relationship").selectOptionId("1"),$("#fam_relationship,#fam_schoollevel").find(".option-select").addClass("disabled"),e.find("#fam_name").setValue(moduleInitData.general.student[0].name),e.find("#fam_appat").setValue(moduleInitData.general.student[0].firstName),e.find("#fam_apmat").setValue(moduleInitData.general.student[0].lastName),e.find("#fam_age").setValue(moduleInitData.general.student[0].age),e.find("#fam_gender").selectRadioId(moduleInitData.general.student[0].gender),"XXXXX"==moduleInitData.general.student[0].firstName&&"XXXXX"!=moduleInitData.general.student[0].lastName&&e.find("#m_checkfirstname").doCheck(),"XXXXX"==moduleInitData.general.student[0].lastName&&"XXXXX"!=moduleInitData.general.student[0].firstName&&e.find("#m_checklastname").doCheck(),e.find("#fam_name").prop("disabled",!0),e.find("#fam_appat").prop("disabled",!0),e.find("#fam_apmat").prop("disabled",!0),e.find("#fam_age").prop("disabled",!0),e.find("#fam_gender .radio-buttons").addClass("disabled"),e.find("#m_checkfirstname").addClass("disabled"),e.find("#m_checklastname").addClass("disabled"),moduleInitData.announcement.scholarshipProgram.id){case"1":$("#fam_schoollevel").selectOptionId("10");break;case"2":$("#fam_schoollevel").selectOptionId("12");break;case"7":$("#fam_schoollevel").selectOptionId("15")}14<=Number(e.find("#fam_age").val())?($("#age14").slideDown("slow"),$("#fam_worked").addClass("required")):($("#age14").slideUp("slow"),$("#fam_worked").removeClass("required"),$("#fam_worked").selectRadioId("false")),e.find(".help_section .h_h1").click(function(){$h1sec=$(this).siblings(".h_h1_section"),"true"==$h1sec.attr("data-collapsed")?($(this).find(".bbva-icon").removeClass("ui-simple-up").addClass("ui-simple-down"),$h1sec.slideUp("slow",function(){$(this).attr("data-collapsed","false")})):($(this).find(".bbva-icon").removeClass("ui-simple-down").addClass("ui-simple-up"),$h1sec.slideDown("slow",function(){$(this).attr("data-collapsed","true")}))}),callbackCloseModal=function(){if(family.fromhome.total!=family.fromhome.getTotal()&&(fn_showAddFam($("#fam_members"),"fromhome"),family.fromhome.members.length))for(var e in $("#nfamilylist").empty(),family.fromhome.members)family.fromhome.members[e].memberid=e,"Delete"!=family.fromhome.members[e].statusRelated&&loadTemplate($("#nfamilylist"),miniTemplates.familymembercard,family.fromhome.members[e],"append");callbackCloseModal=function(){}},fn_showModal(),setTimeout(function(){$("#formfamily").slideDown("slow")},400)},fn_familymembercard=function(e,a){var t=e.find(".checkbox.familycardboss");t.checkeable(function(e){$(".checkbox.familycardboss").addClass("disabled"),e.removeClass("disabled"),family.fromhome.members[Number(e.attr("data-member"))].familyBoss="Sí","OK"==family.fromhome.members[Number(e.attr("data-member"))].statusRelated&&(family.fromhome.members[Number(e.attr("data-member"))].statusRelated="Edit")},function(e){$(".checkbox.familycardboss").removeClass("disabled"),family.fromhome.members[Number(e.attr("data-member"))].familyBoss="No","OK"==family.fromhome.members[Number(e.attr("data-member"))].statusRelated&&(family.fromhome.members[Number(e.attr("data-member"))].statusRelated="Edit")}),"Sí"==a.familyBoss&&t.removeClass("disabled").doCheck(),$scTooltip=e.find(".scholarship-tooltip"),_objdata=$scTooltip.attr("data-tooltip"),""!=_objdata?new Tooltip($scTooltip,{placement:"top",html:!0,title:Mustache.to_html(miniTemplates.shcolarshipdetail.html,JSON.parse(_objdata))}):$scTooltip.remove(),e.find(".btn_editmember").click(function(){var e=jQuery.extend(!0,{},family.fromhome);e.flags={type:"edit",text:"Guardar",memberid:Number($(this).attr("data-member")),group:"fromhome"},e.index=Number($(this).attr("data-member"))+1,fn_verifyCatalogs(["CAT_INST_MEDICA","CAT_EDO_CIVIL","CAT_OCUPACION","CAT_TPO_APOYO","CAT_INST_APOYO","CAT_PARENTESCO-Miembro","CAT_MAX_NVL_ESTUDIO"],function(){loadTemplate($("#modal_generic .body"),templates.family,e)})}),e.find(".btn_deletemember").click(function(){if(_minFam="7"!=moduleInitData.announcement.scholarshipProgram.id?2:1,family.fromhome.getTotal()>_minFam){if("0"==$(this).attr("data-member"))return void loadTemplate($("#modal_generic .body"),miniTemplates.error,{title:"Lo sentimos, no te puedes eliminar",message:"Es obligatorio que te incluyas"});loadTemplate($("#modal_generic .body"),templates.conf,{memberid:$(this).attr("data-member"),title:"¿Deseas eliminar a un familiar?",message:"Al eliminarlo ya no se podrá recuperar",onAccept:function(){var e=!1;if("Sí"==family.fromhome.members[this.memberid].familyBoss&&(e=!0),"true"==__.get(family.fromhome.members[this.memberid],"alreadyExists","")?family.fromhome.members[this.memberid].statusRelated="Delete":family.fromhome.members.splice(this.memberid,1),family.fromhome.total=family.fromhome.getTotal(),$("#n_family").selectOptionId(family.fromhome.getTotal()),$("#nfamilylist").empty(),e)loadTemplate($("#modal_generic .body"),templates.selectboss,{members:family.fromhome.getMembers()});else{for(var a in family.fromhome.members)family.fromhome.members[a].memberid=a,"Delete"!=family.fromhome.members[a].statusRelated&&loadTemplate($("#nfamilylist"),miniTemplates.familymembercard,family.fromhome.members[a],"append");fn_hideModal()}}})}else loadTemplate($("#modal_generic .body"),miniTemplates.error,{title:"Lo sentimos, no puedes eliminar",message:"El número mínimo de integrantes es "+_minFam})})},fn_efamilymodal=function(e,a){var t=jQuery.extend(!0,{},{rel:catalogs["CAT_PARENTESCO-Miembro"]});for(i=0;i<t.rel.length;i++)if(element=t.rel[i],"1"==element.id){t.rel.splice(i,1);break}$("#fam_relationship").comboSelect(t.rel,function(e){"10"==e.id?($("#fam_o_relationship").clearInput(),$("#fam_o_relationship").attr("required","required"),$("#fam_other_relationship").slideDown()):($("#fam_o_relationship").removeAttr("required"),$("#fam_other_relationship").slideUp())}),$("#fam_ocupation").comboSelect(catalogs.CAT_OCUPACION),$("#fam_lives").comboSelect(catalogs.CAT_RESIDENCIA),$("#efamilyformbtn").data("complete",function(e){"edit"==e.flag?("true"==e.alreadyExists&&(e.statusRelated="Edit"),family.awayfromhome.members[e.memberid]=e):(e.statusRelated="Add",family.awayfromhome.members.push(e)),"10"!=e.fam_relationship.id?e.fam_relationship_des=e.fam_relationship.description:e.fam_relationship_des=e.fam_o_relationship,$("#formefamily").slideUp("slow",function(){family.awayfromhome.index()<=family.awayfromhome.total?fn_verifyCatalogs(["CAT_OCUPACION","CAT_RESIDENCIA","CAT_PARENTESCO-Miembro"],function(){loadTemplate($("#modal_generic .body"),templates.efamily,family.awayfromhome)}):($("#ext_family").prev().hasClass("error")&&$("#ext_family").prev().remove(),$("html").animate({scrollTop:$("#nextrafamilylist").offset().top-200},1e3,"swing",function(){for(var e in $("#nextrafamilylist").empty(),family.awayfromhome.members)family.awayfromhome.members[e].memberid=e,"Delete"!=family.awayfromhome.members[e].statusRelated&&loadTemplate($("#nextrafamilylist"),miniTemplates.efamilymembercard,family.awayfromhome.members[e],"append")}),fn_hideModal())})}),"edit"==a.flags.type&&(membertoedit=family.awayfromhome.members[a.flags.memberid],membertoedit.flag="edit",fillForm($("#formefamily"),membertoedit),$("#fam_o_relationship").setValue(__.get(membertoedit,"fam_o_relationship",""))),callbackCloseModal=function(){if(family.awayfromhome.total!=family.awayfromhome.getTotal()&&(fn_showAddFam($("#ext_family"),"awayfromhome"),family.awayfromhome.members.length))for(var e in $("#nextrafamilylist").empty(),family.awayfromhome.members)family.awayfromhome.members[e].memberid=e,"Delete"!=family.awayfromhome.members[e].statusRelated&&loadTemplate($("#nextrafamilylist"),miniTemplates.efamilymembercard,family.awayfromhome.members[e],"append");callbackCloseModal=function(){}},fn_showModal(),setTimeout(function(){$("#formefamily").slideDown("slow")},400)},fn_efamilymembercard=function(e){e.find(".btn_editemember").click(function(){var e=jQuery.extend(!0,{},family.awayfromhome);e.flags={type:"edit",text:"Guardar",memberid:Number($(this).attr("data-member")),group:"awayfromhome"},e.index=Number($(this).attr("data-member"))+1,fn_verifyCatalogs(["CAT_OCUPACION","CAT_RESIDENCIA","CAT_PARENTESCO-Miembro"],function(){loadTemplate($("#modal_generic .body"),templates.efamily,e)})}),e.find(".btn_deletememberaway").click(function(){loadTemplate($("#modal_generic .body"),templates.conf,{memberid:$(this).attr("data-member"),title:"¿Deseas eliminar a un familiar?",message:"Al eliminarlo ya no se podrá recuperar",onAccept:function(){for(var e in"true"==family.awayfromhome.members[this.memberid].alreadyExists?family.awayfromhome.members[this.memberid].statusRelated="Delete":family.awayfromhome.members.splice(this.memberid,1),family.awayfromhome.total=family.awayfromhome.getTotal(),$("#extrafamily").selectOptionId(family.awayfromhome.getTotal()),$("#nextrafamilylist").empty(),family.awayfromhome.members)family.awayfromhome.members[e].memberid=e,"Delete"!=family.awayfromhome.members[e].statusRelated&&loadTemplate($("#nextrafamilylist"),miniTemplates.efamilymembercard,family.awayfromhome.members[e],"append");fn_hideModal()}})})},fn_fam_bbva=function(){$("#relationship_b").comboSelect(catalogs["CAT_PARENTESCO-Soporte"],function(e){"19"==e.id?($("#other_relationship_b").slideDown("slow"),$("#relationship_b_o").attr("required","required")):($("#other_relationship_b").slideUp("slow"),$("#relationship_b_o").removeAttr("required")),$("#relationship_b_o").clearInput()}),fn_showModal(),callbackCloseModal=function(){0==Object.keys(family.bbva.member).length&&fn_showAddFam($("#bbva_employee"),"bbva"),callbackCloseModal=function(){}},"edit"==family.bbva.flag&&(fillForm($("form#fam_bbva"),family.bbva.member),$("#relationship_b_o").setValue(__.get(membertoedit,"relationship_b_o",""))),$("#familybbvabtn").data("complete",function(e){""!=e.relationship_b_o?e.relationship={id:e.relationship_b.id,description:e.relationship_b_o}:e.relationship=e.relationship_b,"edit"==family.bbva.flag&&"true"==__.get(family,"bbva.member.alreadyExists","false")?e.statusRelated="Edit":e.statusRelated="Add",fn_hideModal(),family.bbva.member=e,$("#fam_bbvacard").empty(),loadTemplate($("#fam_bbvacard"),miniTemplates.familybbvacard,family.bbva.member),family.bbva.member&&$("#bbva_employee").prev(".notification.error").length&&$("#bbva_employee").prev(".notification.error").slideUp("slow")})},fn_closeNotification=function(e){e.find(".close-button").click(function(){$(this).closest(".notification").slideUp("slow",function(){$(this).remove()})}),e.slideDown("slow")},fn_closeBtnNotification=function(e){e.find(".btn__addfam").click(function(){var e=$(this).attr("data-group");"bbva"==e?fn_verifyCatalogs(["CAT_PARENTESCO-Soporte"],function(){loadTemplate($("#modal_generic .body"),templates.fambbva,{title:"Agrega la información de tu familiar"})}):"fromhome"==e?fn_verifyCatalogs(["CAT_INST_MEDICA","CAT_EDO_CIVIL","CAT_OCUPACION","CAT_TPO_APOYO","CAT_INST_APOYO","CAT_PARENTESCO-Miembro","CAT_MAX_NVL_ESTUDIO"],function(){loadTemplate($("#modal_generic .body"),templates.family,family.fromhome)}):"awayfromhome"==e&&fn_verifyCatalogs(["CAT_OCUPACION","CAT_RESIDENCIA","CAT_PARENTESCO-Miembro"],function(){loadTemplate($("#modal_generic .body"),templates.efamily,family.awayfromhome)})}),e.slideDown("slow")},fn_modify_bbva=function(){$("#btn_modify_bbva").click(function(e){e.preventDefault(),membertoedit=family.bbva.member,family.bbva.flag="edit",fn_verifyCatalogs(["CAT_PARENTESCO-Soporte"],function(){loadTemplate($("#modal_generic .body"),templates.fambbva,{title:"Agrega la información de tu familiar"})})})},uploadFile={index:0,onFinish:function(){}},fn_uploadfilemodal=function(){var s=0,n={},e=new Dropzone("#dragndrop",{acceptedFiles:"application/pdf,image/jpeg,image/png",dictFileTooBig:"El archivo supera el tamaño permitido de {{maxFilesize}} MB",dictMaxFilesExceeded:"Número máximo de archivos alcanzado",dictInvalidFileType:"Sólo se permiten archivos JPG, PNG y PDF",autoProcessQueue:!1,dictDefaultMessage:"",maxFiles:2,maxFilesize:12,previewTemplate:miniTemplates.filepreview.html,previewsContainer:"#file-preview-wrapper",url:"/",init:function(){this.on("addedfile",function(e){}),this.on("drop",function(){})},accept:function(e,a){document.getElementById("filecontainer").classList.remove("empty"),$("#sbtmfiles").show();var t=this;e.idFile=s;var i=e.previewTemplate.querySelector(".btn-delete-file"),o=e;i.addEventListener("click",function(){t.removeFile(o)}),n[s]={active:!0,base64:""},s++,a()},removedfile:function(e){e.previewTemplate.remove(),0==this.getAcceptedFiles().length&&(document.getElementById("filecontainer").classList.add("empty"),$("#sbtmfiles").hide())},error:function(e,a){e.accepted||(this.removeFile(e),_$form=$(".fileform"),notifyElem=_$form.prev(),0!=notifyElem.length&&notifyElem.hasClass("notification")&&notifyElem.remove(),loadTemplate(_$form,miniTemplates.notification,{type:"error",title:a},"before"))}});$("#btn_sbtmfiles").data("complete",function(i){console.log(i),fn_hideModal(),uploadFile.onFinish=function(){},uploadFile.index=0,_fileDetails=e.getAcceptedFiles(),function a(t){if(t!=_fileDetails.length){currentFile=_fileDetails[t];var e=new FileReader;e.readAsDataURL(currentFile),e.onload=function(e){t!=_fileDetails.length&&(e.target.result,fext=currentFile.name.split("."),fext=fext[fext.length-1],uploadFile.onFinish=function(e){console.log("resp",e)},t==_fileDetails.length-1&&(uploadFile.onFinish=function(e){console.log("_end_fn",e),fn_sendDocument({moduleIndicator:i.module,typeDocument:i.document,schoolGrade:i.grade,schoolPeriod:i.period,folio:e.referenceNumber})}),uploadFile.index++,a(uploadFile.index))}}}(0)}),fn_showModal()},templates={conf:{path:"./views/modal/confirm_m.html",onload:fn_confirmModal},school:{path:"./views/modal/no_school.html",onload:fn_reportschool},family:{path:"./views/modal/familymember.html",onload:fn_familymodal},efamily:{path:"./views/modal/efamilymember.html",onload:fn_efamilymodal},fambbva:{path:"./views/modal/fam_bbva.html",onload:fn_fam_bbva},deletefam:{path:"./views/modal/delete_fam.html",onload:fn_deleteFam},selectboss:{path:"./views/modal/select_boss.html",onload:fn_selectboss},confirmAllData:{path:"./views/modal/confirm_data.html",onload:fn_confirmAllModal},confirmemail:{path:"./views/modal/confirm_email.html",onload:fn_confirmemail},ufile:{path:"./views/modal/uploadfile.html",onload:fn_uploadfilemodal},notify:{path:"./views/modal/notifications.html",onload:fn_opennotification}};function loadTemplate(t,i,o,s){function e(e){var a=$(Mustache.to_html(e,o));t[s](a),"html"==s&&window.validateControl(t),void 0!==i.html&&(i.html=e),i.onload(a,o)}void 0===s&&(s="html"),i?o?void 0!==i.html?e(i.html):void 0!==i.path&&$.get(i.path,e):console.warn("loadTemplate: data is null ["+i+"]"):console.error("loadTemplate: template is undefined ["+t+"]")}var miniTemplates={success:{onload:fn_aceptModal,html:'<div class="title-gray">{{title}}</div><div class="step-container"><div class="icon-m icon-s"></div><div class="grid-c"><div class="grid-item"><div class="message-modal"><div>{{message}}</div></div></div></div><div class="actionsection"><div class="submtbtn"><span title="Enviar" aria-label="Enviar" class="btn__basic btn_acept"><span aria-hidden="true">Aceptar</span></span></div></div></div>'},error:{onload:fn_aceptModal,html:'<div class="title-gray">{{title}}</div><div class="step-container"><div class="icon-m icon-e"></div><div class="grid-c"><div class="grid-item"><div class="message-modal"><div>{{message}}</div></div></div></div><div class="actionsection"><div class="submtbtn"><span title="Enviar" aria-label="Enviar" class="btn__basic btn_acept"><span aria-hidden="true">Aceptar</span></span></div></div></div>'},notification:{onload:fn_closeNotification,html:'<div class="notification {{type}}" style="display: none;"><div class="wrapper"><div class="icon"><i class="bbva-icon"></i></div><div class="message"><div class="message__heading">{{title}}</div><span class="message__body">{{message}}</span></div><div class="close-button"><i class="bbva-icon ui-x"></i></div></div></div>'},btnnotification:{onload:fn_closeBtnNotification,html:'<div class="notification {{type}}" style="display: none;"><div class="wrapper"><div class="icon"><i class="bbva-icon"></i></div><div class="message"><div class="message__heading">{{title}}</div><span class="message__body">{{message}}</span></div><div><span title="{{button}}" aria-label="{{button}}" class="btn__basic btn__addfam" data-group="{{section}}"><span aria-hidden="true">{{button}}</span></span></div></div></div>'},shcolarshipdetail:{onload:function(){},html:'<p><i class="bbva-icon ui-gradution-cap"></i>Tipo de apoyo: {{tipo}}</p><p><i class="bbva-icon ui-receipt"></i>Programa o institución: {{programa}}</p><p><i class="bbva-icon ui-ticket"></i>Monto mensual: ${{monto}}</p>'},familymembercard:{onload:fn_familymembercard,html:'<div class="grid-item card gray familycard animated fadeIn"><p class="title">{{fam_name}} {{fam_appat}} {{fam_apmat}}<i class="bbva-icon ui-profile"></i></p><p class="relationship">{{fam_relationship_des}}</p><div class="separator"></div><p class="checkbox-area"><span class="text inf">Jefe del hogar&nbsp;</span><span class="checkbox familycardboss disabled{{familybossclass}}" data-member="{{memberid}}"><i class="bbva-icon ui-checkmark"></i></span></p><div class="moreinfo"><p class="inf">Edad: <span>{{fam_age}}</span></p><p class="inf">Sexo: <span>{{fam_gender.description}}</span></p><p class="inf">Estado civil: <span>{{fam_civil.description}}</span></p><p class="inf">Grado de estudio: <span>{{fam_schoollevel.description}}</span></p><p class="inf">Asiste a la escuela: <span>{{fam_studing.description}}</span></p><p class="inf">Ocupación: <span>{{fam_ocupation.description}}</span></p><p class="inf">Atención médica: <span>{{fam_medic.description}}</span></p><p class="inf">Ingresos mensuales: <span>${{total_f}} MXN</span></p><p class="inf">Trabajó el último mes: <span>{{fam_worked.description}}</span></p><p class="inf">Recibe otra beca: <span>{{fam_otherschoolarship.description}} <i class="bbva-icon ui-show scholarship-tooltip" data-tooltip="{{infoscolarship}}"></i></span></p></div><div class="centertext"><span title="Modificar" aria-label="Modificar" class="btn__basic btn__clearbg btn_editmember" data-member="{{memberid}}"><i class="bbva-icon ui-edit icon-fix"></i><span aria-hidden="true">Modificar</span></span><span title="Eliminar" aria-label="Eliminar" class="btn__basic btn__clearbg btn_deletemember" data-member="{{memberid}}"><i class="bbva-icon ui-trash icon-fix"></i><span aria-hidden="true">Eliminar</span></span></div></div>'},efamilymembercard:{onload:fn_efamilymembercard,html:'<div class="grid-item card gray familycard animated fadeIn"><p class="title">{{fam_name}} {{fam_appat}} {{fam_apmat}}<i class="bbva-icon ui-profile"></i></p><p class="relationship">{{fam_relationship_des}}</p><div class="separator"></div><div class="moreinfo"><p class="inf">Ocupación: <span>{{fam_ocupation.description}}</span></p><p class="inf">Vive: <span>{{fam_lives.description}}</span></p><p class="inf">Aporta: <span>${{total_f}} MXN</span></p></div><div class="centertext"><span title="Modificar" aria-label="Modificar" class="btn__basic btn__clearbg btn_editemember" data-member="{{memberid}}"><i class="bbva-icon ui-edit icon-fix"></i><span aria-hidden="true">Modificar</span></span><span title="Eliminar" aria-label="Eliminar" class="btn__basic btn__clearbg btn_deletememberaway" data-member="{{memberid}}"><i class="bbva-icon ui-trash icon-fix"></i><span aria-hidden="true">Eliminar</span></span></div></div>'},familybbvacard:{onload:fn_modify_bbva,html:'<div class="grid-item card gray familycard bounce"><p class="title">{{name_fbbva}} {{lastname_fbbva}} {{slastname_fbbva}}<i class="bbva-icon ui-profile"></i></p><p class="relationship">{{relationship.description}}</p><div class="separator"></div><div class="moreinfo"><p class="inf">Puesto: <span>{{workposition_fbbva}}</span></p><p class="inf">Área de trabajo: <span>{{workstation_fbbva}}</span></p></div><br><div class="centertext"><span title="Modificar" aria-label="Modificar" class="btn__basic btn__clearbg" id="btn_modify_bbva"><i class="bbva-icon ui-edit icon-fix"></i><span aria-hidden="true">Modificar</span></span></div></div>'},m_familycard:{onload:fn_nothing,html:'<div class="grid-item card gray  familycard mod"><p class="title">{{name}} {{lastName}} {{secondLastName}}<i class="bbva-icon ui-profile"></i></p><p class="relationship">{{relationship.description}}</p><div class="separator"></div><div class="read-only"><p>Edad: <span>{{personDetail.age}}</span></p><p>Sexo: <span>{{personDetail.gender.id}}</span></p><p>Estado civil: <span>{{personDetail.maritalStatus.description}}</span></p><p>Grado de estudio: <span>{{personDetail.education.description}}</span></p><p>Asiste a la escuela: <span>{{student}}</span></p><p>Ocupaci&oacute;n: <span>{{personDetail.economicActivity.description}}</span></p><p>Atenci&oacute;n m&eacute;dica: <span>{{personDetail.healthCareEntity.description}}</span></p><p>Ingresos mensuales: <span>{{incomesamount}} MXN</span></p><p>Trabaj&oacute; el &uacute;ltimo mes: <span>{{hasWorked}}</span></p><p>Recibe otra beca: <span>{{isotherG}}</span></p><div style="display: {{fam_otherschoolarship}}"><p>Tipo de beca: <span>{{personDetail.otherGovernmentScholarship.otherGovernmentScholarshipType.description}}</p><p>Programa de beca: <span>{{otherScholarshipProgramDescription}}</p><p>Monto de la beca: <span>{{otherGovernmentScholarshipamount}} MXN</p></div></div></div>'},m_efamilycard:{onload:fn_nothing,html:'<div class="grid-item card gray  familycard mod"><p class="title">{{name}} {{lastName}} {{secondLastName}}<i class="bbva-icon ui-profile"></i></p><p class="relationship">{{relationship.description}}</p><div class="separator"></div><div class="read-only"><p>Ocupaci&oacute;n: <span>{{personDetail.economicActivity.description}}</span></p><p>Vive: <span>{{personDetail.residencePlace.description}}</span></p><p>Aporta: <span>{{incomesamount}} MXN</span></p></div></div>'},m_bbvafamilycard:{onload:fn_nothing,html:'<div class="grid-item card gray  familycard mod bounce"><p class="title">{{name}} {{lastName}} {{secondLastName}}<i class="bbva-icon ui-profile"></i></p><p class="relationship">{{relationship.description}}</p><div class="separator"></div><div class="read-only"><p>Puesto: <span>{{personDetail.professionPosition}}</span></p><p>&Aacute;rea de trabajo: <span>{{personDetail.managementUnit}}</span></p></div></div>'},filepreview:{html:'<div class="uploadfile animated fadeInLeft"><div class="wrapper"><div class="message"><div class="message__heading dz-filename"><span data-dz-name></span></div><span class="message__body"><span class="remove btn-delete-file"><i class="ui-trash"></i> Eliminar</span></span></div></div></div>'},visorProfile:{onload:function(){},html:'<div id="profile-view"><figure><img src="{{photo}}" alt=""></figure></div><div class="submtbtn"><span title="Continuar" aria-label="Continuar" class="help_section" id="btn_change_profile"><span aria-hidden="true" class="h_h1">Cambiar foto <i class="bbva-icon ui-camera"></i></span></span></div>'}};!function(s){s.fn.inputable=function(){return s(this).each(function(){t=this;var a=document.createElement("span"),e=document.createElement("div");if(!t.hasAttribute("required")){var i=document.createElement("span");s(i).addClass("is-optional"),t.parentElement.appendChild(i)}if(s(e).addClass("placeholder-wrapper"),t.parentElement.appendChild(e),a.appendChild(document.createTextNode(t.getAttribute("data-placeholder"))),s(a).addClass("placeholder-simulator"),e.appendChild(a),e.appendChild(t),e.appendChild(a),$t=s(t),ele_parent=$t.parents(".form-group"),0===ele_parent.find("span.text-message").length&&ele_parent.append("<p class='i-message'><span class='text-message'>&nbsp;</span></p>"),a.addEventListener("click",function(){s(this).siblings("input").focus()}),t.addEventListener("keyup",function(){if(t=s(this),0===t.val().length)t.removeClass("noempty"),t.removeClass("has-error");else{var e=t.siblings("small");s(e).remove(),s(t).removeError()}}),t.addEventListener("focus",function(){for(var e in _t={top:"5px",fontSize:"12px"},_t)a.style[e]=_t[e]}),t.addEventListener("blur",function(){if(t=s(this),0===t.val().length){for(var e in _t={top:"16px",fontSize:"15px"},_t)a.style[e]=_t[e];t.removeClass("noempty")}else t.removeClass("has-error"),s(t).addClass("noempty")}),0!==t.value.length){for(var o in _t={top:"5px",fontSize:"12px"},_t)a.style[o]=_t[o];s(t).addClass("noempty")}})},s.fn.showError=function(e){return this.each(function(){element=s(this),ele_parent=element.parents(".form-group"),ele_parent.addClass("hasError"),""!=e&&ele_parent.find("span.text-message").html("<i class='bbva-icon ui-warning'></i>"+e)})},s.fn.removeError=function(){return this.each(function(){element=s(this),ele_parent=element.parents(".form-group"),ele_parent.removeClass("hasError"),ele_parent.find("span.text-message").html('<i class="bbva-icon ui-empty"></i>&nbsp;')})},s.fn.clearInput=function(){return this.each(function(){element=s(this),element.removeError(),element.val(""),element.siblings(".placeholder-simulator").css({top:"16px","font-size":"15px"})})},s.fn.setValue=function(e){return this.each(function(){""!=e&&(element=s(this),element.val(e),element.siblings(".placeholder-simulator").css({top:"5px","font-size":"12px"}))})}}(jQuery),function(n){n.fn.comboSelect=function(e,a){return this.each(function(){var o=n(this);"function"==typeof a?o.data("selectCallback",a):"function"!=typeof o.data("selectCallback")&&o.data("selectCallback",function(){}),o.data("options",e),o.data("selected",null),o.find(".list-result").html(Mustache.to_html(n.fn.comboSelect.template,{items:e}));var s=o.find(".option-select");s.data("open",!1),s.removeAttr("open"),s.find("li").click(function(){var e=n(this),a=o.data("options");if(null==o.data("selected")||e.attr("data-id")!=o.data("selected").id)for(var t=0;t<a.length;t++){var i=a[t];if(i.id==e.attr("data-id")){o.data("selected",i),o.removeComboError(),o.find(".option-text").removeClass("center"),o.find(".selected-option").text(i.description),o.addClass("noempty"),n.fn.hideOptions(s),o.data("selectCallback")(i);break}}}),!0!==o.data("inicializate")&&(s.find(".select-title").click(function(){s.data("open")?n.fn.hideOptions(s):n.fn.showOptions(s)}),o.data("inicializate",!0),null==n(document).data("comboselectatached")&&(n(document).click(function(e){n(e.target).hasClass("sl")||($formOpened=n(".form-group-select .option-select[open]"),0!=$formOpened.length&&n.fn.hideOptions($formOpened))}),n(document).data("comboselectatached",!0)),void 0!==o.data("promess-select")&&(o.selectOptionId(o.data("promess-select")),o.data("promess-select",void 0)),void 0!==o.data("promess-selectdesc")&&(o.selectOptionDescription(o.data("promess-selectdesc")),o.data("promess-select",void 0)))})},n.fn.showOptions=function(e){e.hasClass("disabled")||(n.fn.hideOptions(n(".form-group-select .option-select[open]").not(e)),e.find("ul").slideDown(),e.data("open",!0),e.attr("open",""),e.find(".select-title .bbva-icon").css({transform:"rotate(180deg)"}))},n.fn.selectOptionId=function(e){context=this;var a=context.data("options");if(void 0!==a)for(var t=0;t<a.length;t++){var i=a[t];if(i.id==e){context.data("selected",i),context.removeComboError(),context.find(".option-text").removeClass("center"),context.find(".selected-option").text(i.description),context.data("selectCallback")(i);break}}else context.data("promess-select",e)},n.fn.selectOptionDescription=function(e){context=this;var a=context.data("options");if(void 0!==a)for(var t=0;t<a.length;t++){var i=a[t];if(i.description==e){context.data("selected",i),context.removeComboError(),context.find(".option-text").removeClass("center"),context.find(".selected-option").text(i.description),context.data("selectCallback")(i);break}}else context.data("promess-selectdesc",e)},n.fn.hideOptions=function(e){e.find("ul").slideUp(),_context=e.closest(".form-group-select"),_context.hasClass("required")&&null==_context.getOptionSelected()&&_context.showComboError(),e.data("open",!1),e.removeAttr("open"),e.find(".select-title .bbva-icon").css({transform:"rotate(0deg)"})},n.fn.getOptionSelected=function(){return this.data("selected")||null},n.fn.onSelect=function(e){"function"==typeof e&&this.data("selectCallback",e)},n.fn.reset=function(){return this.find(".option-text").addClass("center"),this.find(".selected-option").text(""),this.find(".option-select").removeClass("disabled"),this.removeComboError(),this.removeClass("noempty"),this.data("selected",null),this},n.fn.showComboError=function(e){return this.each(function(){n(this).addClass("hasError"),e=e||"Selecciona una opción",n(this).find("span.text-message").html('<i class="bbva-icon ui-warning"></i>'+e)})},n.fn.removeComboError=function(){return this.each(function(){n(this).removeClass("hasError"),n(this).find("span.text-message").html("&nbsp;")})},n.fn.comboSelect.template='<ul style="display:none">{{#items}}<li data-id="{{id}}">{{description}}</li>{{/items}}</ul>'}(jQuery);var day=[{id:"01",description:"01"},{id:"02",description:"02"},{id:"03",description:"03"},{id:"04",description:"04"},{id:"05",description:"05"},{id:"06",description:"06"},{id:"07",description:"07"},{id:"08",description:"08"},{id:"09",description:"09"},{id:"10",description:"10"},{id:"11",description:"11"},{id:"12",description:"12"},{id:"13",description:"13"},{id:"14",description:"14"},{id:"15",description:"15"},{id:"16",description:"16"},{id:"17",description:"17"},{id:"18",description:"18"},{id:"19",description:"19"},{id:"20",description:"20"},{id:"21",description:"21"},{id:"22",description:"22"},{id:"23",description:"23"},{id:"24",description:"24"},{id:"25",description:"25"},{id:"26",description:"26"},{id:"27",description:"27"},{id:"28",description:"28"},{id:"29",description:"29"},{id:"30",description:"30"},{id:"31",description:"31"}],month=[{id:"01",description:"Ene",monthcomplete:"ENERO"},{id:"02",description:"Feb",monthcomplete:"FEBRERO"},{id:"03",description:"Mar",monthcomplete:"MARZO"},{id:"04",description:"Abr",monthcomplete:"ABRIL"},{id:"05",description:"May",monthcomplete:"MAYO"},{id:"06",description:"Jun",monthcomplete:"JUNIO"},{id:"07",description:"Jul",monthcomplete:"JULIO"},{id:"08",description:"Ago",monthcomplete:"AGOSTO"},{id:"09",description:"Sep",monthcomplete:"SEPTIEMBRE"},{id:"10",description:"Oct",monthcomplete:"OCTUBRE"},{id:"11",description:"Nov",monthcomplete:"NOVIEMBRE"},{id:"12",description:"Dic",monthcomplete:"DICIEMBRE"}];!function(a){a.fn.radiobutton=function(e){return this.each(function(){$rad=a(this),null==$rad.data("resetCallback")&&$rad.data("resetCallback",function(){}),null!=e&&$rad.data("checkedCallback",e),$button=$rad.find(".radio"),$rad.append("<p class='i-message'><span class='text-message'>&nbsp;</span></p>"),$button.click(function(){a(this).parents(".radio-buttons").hasClass("disabled")||a.fn.selectRadio(a(this))})})},a.fn.getButtonSelected=function(){return{id:a(this).attr("data-selectedid"),description:a(this).attr("data-selected")}},a.fn.onChecked=function(e){return"function"==typeof e&&this.data("checkedCallback",e),this},a.fn.onRadioReset=function(e){return"function"==typeof e&&this.data("resetCallback",e),this},a.fn.clearRadio=function(){return this.removeRadioError(),this.find(".radio.checked").removeClass("checked"),this.removeAttr("data-selectedid"),this.removeAttr("data-selected"),this.data("resetCallback")(),this},a.fn.showRadioError=function(e){return a(this).addClass("hasError"),a(this).find("span.text-message").html('<i class="hasError bbva-icon ui-warning"></i>'+e),this},a.fn.removeRadioError=function(){return a(this).removeClass("hasError"),a(this).find("span.text-message").html("&nbsp;"),this},a.fn.selectRadioId=function(e){return a.fn.selectRadio(a(this).find("[data-id='"+e+"']")),this},a.fn.selectRadio=function(e){if(!e.hasClass("checked")){$rad_p=e.closest(".radio-section"),$buttons=$rad_p.find(".radio"),$buttons.removeClass("checked"),e.addClass("checked");var a={id:e.attr("data-id"),description:e.closest(".radio-button").find(".radio-label").text()};$rad_p.attr("data-selectedid",a.id),$rad_p.attr("data-selected",a.description),$rad_p.removeRadioError(),null!=$rad_p.data("checkedCallback")&&$rad_p.data("checkedCallback")(a)}return this}}(jQuery),function(t){t.fn.checkeable=function(e,a){return this.each(function(){"function"!=typeof e&&(e=function(){}),"function"!=typeof a&&(a=function(){}),t(this).data("checkcallback",e),t(this).data("uncheckcallback",a),t(this).click(function(){t(this).hasClass("disabled")||(t(this).hasClass("checked")?(t(this).removeClass("checked"),t(this).data("uncheckcallback")(t(this))):(t(this).removeCheckboxError(),t(this).addClass("checked"),t(this).data("checkcallback")(t(this))))})})},t.fn.isChecked=function(){return t(this).hasClass("checked")},t.fn.doCheck=function(){return this.each(function(){t(this).addClass("checked"),t(this).data("checkcallback")(t(this))})},t.fn.unCheck=function(){return this.each(function(){t(this).removeClass("checked")})},t.fn.showCheckBoxError=function(){t(this).addClass("error")},t.fn.removeCheckboxError=function(){t(this).removeClass("error")},t.fn.ckeckCallback=function(e,a){return this.each(function(){"function"!=typeof e&&(e=function(){}),"function"!=typeof a&&(a=function(){}),t(this).data("checkcallback",e),t(this).data("uncheckcallback",a)})}}(jQuery),function(s){s.fn.applyList=function(o,e){o.find(".list-result").html(Mustache.to_html(s.fn.searchList.templates[o.attr("data-template")],e)),o.find(".list-result")[0].scrollTo(0,0),o.find(".result-item").click(function(e){o.find(".result-item").not(this).removeClass("selected");for(var a=o.data("items"),t=0;t<a.items.length;t++){var i=a.items[t];if(i[a.filterid]==s(this).attr("data-id")){o.data("selected",i),o.find(".placeholder-simulator").attr("style","top: 5px; font-size: 12px;"),o.find("input[name='filter']").val(i[a.filtertext]).removeError(),o.find(".list-result").slideUp(),o.data("selectCallback")(i);break}}s(this).addClass("selected")})},s.fn.searchList=function(e,i){return this.each(function(){var a=s(this);"function"==typeof i?a.data("selectCallback",i):"function"!=typeof a.data("selectCallback")&&a.data("selectCallback",function(){}),a.data("items",e),a.data("selected",null),s.fn.applyList(a,e);var t=a.find("input[name='filter']");t.clearInput(),a.find(".list-result").slideDown(),null==a.data("search-atached")&&(t.focus(function(e){e.preventDefault(),a.find(".list-result").slideDown(),s.fn.filterList(a,s(this).val())}),t.blur(function(e){null!=a.data("selected")&&(a.find(".placeholder-simulator").attr("style","top: 5px; font-size: 12px;"),a.find("input[name='filter']").val(a.data("selected")[a.data("items").filtertext]).removeError(),a.find(".list-result").slideUp())}),t.keyup(function(e){s.fn.filterList(a,t.val())})),a.data("search-atached",!0),void 0!==a.data("promess-select")&&(a.selectFromList(a.data("promess-select")),a.data("promess-select",void 0))})},s.fn.selectFromList=function(i){return this.each(function(){var e=s(this);if(_allitems=e.data("items"),"undefined"!=typeof _allitems)for(var a=0;a<_allitems.items.length;a++){var t=_allitems.items[a];if(t[_allitems.filterid]==i){e.data("selected",t),e.find(".placeholder-simulator").attr("style","top: 5px; font-size: 12px;"),e.find("input[name='filter']").val(t[_allitems.filtertext]).removeError(),e.find(".list-result").slideUp(),e.data("selectCallback")(t);break}}else e.data("promess-select",i)})},s.fn.unselect=function(){return this.each(function(){var e=s(this);e.data("selected",null),e.find("input[name='filter']").clearInput()})},s.fn.filterList=function(e,a){var t={items:[]},i=new RegExp(s.fn.escapeRegExp(s.fn.removeAcute(a)),"i"),o=e.data("items");t.items=s.map(o.items,function(e){if(i.test(s.fn.removeAcute(e[o.filtertext])))return e}),s.fn.applyList(e,t)},s.fn.getSelected=function(){return(context=this).data("selected")||null},s.fn.escapeRegExp=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},s.fn.removeAcute=function(e){for(var a=[{i:"á",o:"a"},{i:"é",o:"e"},{i:"í",o:"i"},{i:"ó",o:"o"},{i:"ú",o:"u"}],t=e.toLowerCase(),i=0;i<a.length;i++){var o=a[i];t=t.replace(o.i,o.o)}return t},s.fn.searchList.templates={simple:'{{#items}}<div class="result-item" data-id="{{description}}"><div class="item-title"><i class="bbva-icon bbva-icon__2_027_place"></i>{{description}}</div></div>{{/items}}',fulldetail:'{{#items}}<div class="result-item" data-id="{{keyWorkplace}}"><div class="item-title"><i class="bbva-icon bbva-icon__5_002_build"></i>{{schoolOficialName}}</div><div class="item-details"><p><span class="tagname">Tipo:</span> {{schoolAcronym}}</p><p><span class="tagname">CCT:</span> {{keyWorkplace}}</p><p><span class="tagname">Dirección:</span> {{schoolAddress}}</p><p><span class="tagname">Localidad:</span></i> {{location}}</p></div></div>{{/items}}'}}(jQuery);var expRegs={CURP:{regEx:/^[A-Z]{1}[AEIOUX]{1}[A-Z]{2}[0-9]{2}(0[1-9]|1[0-2])(0[1-9]|1[0-9]|2[0-9]|3[0-1])[HM]{1}(AS|BC|BS|CC|CS|CH|CL|CM|DF|DG|GT|GR|HG|JC|MC|MN|MS|NT|NL|OC|PL|QT|QR|SP|SL|SR|TC|TS|TL|VZ|YN|ZS|NE)[B-DF-HJ-NP-TV-Z]{3}[0-9A-Z]{1}[0-9]{1}$/,error:"Ingresa una CURP válida"},EMAIL:{regEx:/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/,error:"Ingresa un email válido"},CCT:{regEx:/^(0[1-9]|1[0-9]|2[0-9]|3[0-2])[A-Z]{3}[0-9]{4}[A-Z]{1}$/,error:"Por favor valida la clave de tu escuela"},PROM:{regEx:/10$|^\d(\.\d\d?)?$/,error:"Ingresa una calificación entre 0 y 10"},FB:{regEx:/(http|https):\/\/(?:www\.)facebook\.com\/(\b(([\w\-\.])*\/{0,1})|\b(profile\.php\?id=\d.*))$/,error:"Por favor ingresa una url válida"},ZIPCODE:{regEx:/^\d{5}/,error:"Por favor ingresa un código postal válido"},YEAR_50_ACT:{regEx:{test:function(e){return nyear=Number(e),!isNaN(nyear)&&1950<=e&&e<=(new Date).getFullYear()}},error:"Ingresa un año de 1950-actual"},YEAR_80_ACT:{regEx:{test:function(e){return nyear=Number(e),!isNaN(nyear)&&1980<=e&&e<=(new Date).getFullYear()}},error:"Ingresa un año de 1980-actual"},YEAR_MIN_80:{regEx:{test:function(e){return nyear=Number(e),!isNaN(nyear)&&1980<=e}},error:"Ingresa un año desde 1980"},FOL:{regEx:/^[0-9]{2}[127][0-9]{8}$/},FUN:{regEx:/^FUN[0-9]{8}$/}},formvalidations=[{selector:"input.form-control,textarea.form-control",invalid:function(e){return e.prop("required")&&(""==e.val().trim()||e.parents(".form-group").hasClass("hasError"))},saveValue:function(e,a){_id=e.attr("id"),a[_id]=void 0!==e.inputmask?e.inputmask("unmaskedvalue"):e.val()},resetValue:function(e){e.clearInput()},showError:function(e){e.parents(".form-group").hasClass("hasError")||e.showError("Campo obligatorio")}},{selector:".form-group-select",invalid:function(e){return e.hasClass("required")&&null==e.getOptionSelected()},saveValue:function(e,a){_id=e.attr("id"),a[_id]=e.getOptionSelected()},resetValue:function(e){e.reset()},showError:function(e){e.showComboError("Selecciona una opción")}},{selector:".radio-section",invalid:function(e){return e.hasClass("required")&&null==e.getButtonSelected().id},saveValue:function(e,a){_id=e.attr("id"),a[_id]=e.getButtonSelected()},resetValue:function(e){e.clearRadio()},showError:function(e){e.showRadioError("Selecciona una opción")}},{selector:".checkbox",invalid:function(e){return e.hasClass("required")&&!e.isChecked()},saveValue:function(e,a){_id=e.attr("id"),a[_id]=e.isChecked()},resetValue:function(e){e.unCheck()},showError:function(e){e.showCheckBoxError("")}},{selector:".list-filter-result",invalid:function(e){return!1},saveValue:function(e,a){_id=e.attr("id"),a[_id]=e.getSelected()},resetValue:function(e){e.unselect()},showError:function(e){}}];function hasAttr(e,a){var t=e.attr(a);return void 0!==t&&!1!==t}!function(e,a){a.validateControl=function(e){e.find(".openuploadfile").click(function(){loadTemplate($("#modal_generic .body"),templates.ufile,{})}),e.find("input[type='text']").inputable(),e.find("textarea").inputable(),e.find(".radio-section").radiobutton(),e.find(".uppercase").keyup(function(e){$(this).val($(this).val().replace(/á/gi,"A").replace(/é/gi,"E").replace(/í/gi,"I").replace(/ó/gi,"O").replace(/ú/gi,"U").toUpperCase())}),e.find(".letters").keypress(function(e){return 97<=e.charCode&&e.charCode<=122||65<=e.charCode&&e.charCode<=90||0==e.charCode||32==e.charCode||45==e.charCode||46==e.charCode||209==e.charCode||241==e.charCode||225==e.charCode||233==e.charCode||237==e.charCode||243==e.charCode||250==e.charCode||193==e.charCode||201==e.charCode||205==e.charCode||211==e.charCode||218==e.charCode||220==e.charCode||252==e.charCode}),e.find(".alphanumeric").keypress(function(e){return 97<=e.charCode&&e.charCode<=122||65<=e.charCode&&e.charCode<=90||48<=e.charCode&&e.charCode<=57||0==e.charCode||32==e.charCode}),e.find(".letnum").keypress(function(e){return 97<=e.charCode&&e.charCode<=122||65<=e.charCode&&e.charCode<=90||0==e.charCode||32==e.charCode||45==e.charCode||46==e.charCode||209==e.charCode||241==e.charCode||225==e.charCode||233==e.charCode||237==e.charCode||243==e.charCode||250==e.charCode||193==e.charCode||201==e.charCode||205==e.charCode||211==e.charCode||218==e.charCode||220==e.charCode||252==e.charCode||48<=e.charCode&&e.charCode<=57}),e.find(".decimals").keypress(function(e){return 48<=e.charCode&&e.charCode<=57||46==e.charCode}),e.find(".numbers").keypress(function(e){return 48<=e.charCode&&e.charCode<=57}),e.find(".numg").keypress(function(e){return 48<=e.charCode&&e.charCode<=57||45==e.charCode||97<=e.charCode&&e.charCode<=122||65<=e.charCode&&e.charCode<=90}),e.find("input[data-regex]").not("input[data-confirm]").blur(function(){_$this=$(this),_regex=$(this).attr("data-regex"),_thisval=$(this).val(),""==_thisval||expRegs[_regex].regEx.test(_thisval)?_$this.removeError():_$this.showError(expRegs[_regex].error)}),e.find("input[required]").attr("data-required",!0),e.find("input[data-confirm]").each(function(){confirm_element=$(this),main_element=$(confirm_element.attr("data-confirm")),main_element.keyup(function(){$confirm_element=$('[data-confirm="#'+$(this).attr("id")+'"]'),""!=$(this).val()?(hasAttr($(this),"data-required")||$(this).attr("required","required"),hasAttr($confirm_element,"data-required")||($confirm_element.parents(".grid-item").slideDown(),$confirm_element.attr("required",!0))):hasAttr($confirm_element,"data-required")||($confirm_element.parents(".grid-item").slideUp(),$confirm_element.removeAttr("required"),$confirm_element.val(""),$confirm_element.removeError())}),confirm_element.add(main_element).blur(function(){var e,a;a=hasAttr($(this),"data-confirm")?(e=$(this),$(e.attr("data-confirm"))):(e=$('[data-confirm="#'+$(this).attr("id")+'"]'),$(this)),""!=e.val()&&e.val()!=a.val()?(e.showError("Los correos no coinciden"),a.showError("")):""!=a.val()||hasAttr(a,"data-required")?""!=e.val()&&e.val()==a.val()&&(e.removeError(),a.removeError(),expRegs.EMAIL.regEx.test(a.val())||(a.showError(expRegs.EMAIL.error),e.showError(expRegs.EMAIL.error))):(a.removeAttr("required"),a.removeError(),e.removeError(),e.removeAttr("required"))})}),e.find("input.phonenumber").inputmask({mask:"(999) 999-9999",showMaskOnHover:!1}).blur(function(){_phonen=$(this).inputmask("unmaskedvalue").length,0<_phonen&&_phonen<10&&$(this).showError("Ingresa el número completo")}),e.find("input.no-repeat").each(function(){$(this).keyup(function(){var e=$(".no-repeat"),t="",a="",i=$().add($(this)),o=0;$.each(e,function(e,a){t=$().add(a),i.is(t)||i.val()===t.val()&&(i.showError("No se permite número telefónico repetido"),i.addClass("repeated"))});for(var s=0;s<e.length;s++){t=$().add(e[s]);for(var n=o=0;n<e.length;n++)a=$().add(e[n]),t.is(a)||t.hasClass("repeated")&&t.val()!==a.val()&&o++;2===o&&(t.removeError(),t.removeClass("repeated"))}})}),e.find("input.mxnamount").focus(function(){$(this).inputmask("currency",{rightAlign:!1,autoUnmask:!0,allowPlus:!1,allowMinus:!1,integerDigits:"6"})}).blur(function(){$(this).inputmask&&0==$(this).inputmask("unmaskedvalue").length&&$(this).inputmask("remove")}),e.find(".lastnameb").each(function(){$(this).keyup(function(){var e=$().add($(this)),a=e.closest(".grid-container").find('[data-targetdisable="#'+e.attr("id")+'"]');a.addClass("disabled");var t=e.closest(".grid-container").find('[data-targettoggle="#'+a.attr("id")+'"]');""!==e.val()||t.hasClass("checked")||a.removeClass("disabled")})}),e.find("form").each(function(){$form=$(this),$form.find("input.form-control").each(function(){$formelement=this,$formelement.addEventListener("blur",function(){$(this).val($(this).val().trim()),this.required&&0==$(this).val().length&&$(this).showError($(this).attr("data-emptymessage")||"Campo obligatorio")})}),$form.find(".form-group-select").each(function(){$formcombo=$(this),$formcombo.find(".option-select").append("<p class='i-message'><span class='text-message'>&nbsp;</span></p>")}),$form.find(".checkbox").checkeable(),$form.find(".checkbox[data-targettoggle]").each(function(){$(this).ckeckCallback(function(){$($(this).attr("data-targetdisable")).clearInput().prop("disabled",!0).prop("required",!1),$($(this).attr("data-targettoggle")).unCheck().addClass("disabled").data("uncheck",!0),$($(this).attr("data-targetdisable")).setValue("XXXXX")}.bind(this),function(){$($(this).attr("data-targetdisable")).clearInput().prop("disabled",!1).prop("required",!0),""===$($($(this).attr("data-targettoggle")).attr("data-targetdisable")).val()&&$($(this).attr("data-targettoggle")).removeClass("disabled").data("uncheck",!1)}.bind(this))}),$form.find(".e-tooltip-f").each(function(){$etooltip=$(this),new Tooltip($etooltip,{placement:"bottom",trigger:"focus",html:!0,title:$etooltip.attr("data-tooltitle")})}),$form.find(".e-tooltip").each(function(){$etooltip=$(this),new Tooltip($etooltip,{placement:"bottom",html:!0,title:$etooltip.attr("data-tooltitle")})}),$form.find("textarea.form-control").each(function(){$formelement=this,$formelement.addEventListener("blur",function(){$(this).val($(this).val().trim()),this.required&&0==$(this).val().length&&$(this).showError($(this).attr("data-emptymessage")||"Campo obligatorio")})}),$form.find(".btn__submit").click(function(){$(this).hasClass("btn__disabled")||(_$form=$(this).closest("form"),allDataForm=function(e){var a={isValid:!0};for(var t in _$form=$(e).closest("form"),formvalidations)_$form.find(formvalidations[t].selector).each(function(){formvalidations[t].saveValue($(this),a),formvalidations[t].invalid($(this))&&(a.isValid=!1,formvalidations[t].showError($(this)))});return a}(this),formValidations="function"!=typeof _$form.data("validations")||_$form.data("validations")(allDataForm),!_$form.hasClass("notify-on-error")||allDataForm.isValid&&formValidations?(0!=_$form.prev().length&&_$form.prev().hasClass("notification")&&_$form.prev().remove(),"function"==typeof $(this).data("complete")&&$(this).data("complete")(allDataForm)):(_$form.parents(".modal").length?(notifyElem=_$form.find(".actionsection:last").prev(),0!=notifyElem.length&&notifyElem.hasClass("notification")&&notifyElem.remove(),loadTemplate(_$form.find(".actionsection:last"),miniTemplates.notification,{type:"error",title:"Datos obligatorios incompletos",message:"Por favor ingresa todos campos obligatorios"},"before")):(_scrollTo=hasAttr(_$form,"data-notify")?_$form.attr("data-notify"):"Edge"==BrowserDetect.browser?"body":"html",$(_scrollTo).animate({scrollTop:_$form.offset().top-100},2e3,"swing",function(){notifyElem=_$form.prev(),0!=notifyElem.length&&notifyElem.hasClass("notification")&&notifyElem.remove(),loadTemplate(_$form,miniTemplates.notification,{type:"error",title:"Datos obligatorios incompletos",message:"Por favor ingresa todos campos obligatorios"},"before")})),hasAttr(_$form,"data-status")&&($(_$form.attr("data-status")).removeClass("complete"),$(_$form.attr("data-status")).addClass("incomplete"),$(_$form.attr("data-status")).html('<i class="bbva-icon ui-warning"></i>Incompleto'))))})})},a.validateControl(e),a.fillForm=function(t,e){$.each(e,function(e,a){$3l=t.find("#"+e),$3l.is("input")||$3l.is("textarea")?($3l.clearInput(),$3l.setValue(a)):$3l.hasClass("form-group-select")?($3l.reset(),null!=a&&$3l.selectOptionId("object"==typeof a?a.id:a)):$3l.hasClass("radio-section")?($3l.clearRadio(),$3l.selectRadioId("object"==typeof a?a.id:a)):$3l.hasClass("list-filter-result")?($3l.unselect(),$3l.selectFromList(a)):$3l.hasClass("checkbox")?($3l.unCheck(),a&&$3l.doCheck()):console.log("fillForm: Element "+e+" doesn't exists in form",t)})},a.resetForm=function(e){for(var a in formvalidations)e.find(formvalidations[a].selector).each(function(){formvalidations[a].resetValue($(this))})}}($(document),window);var __={get:function(e,a,t){var i=null==e?void 0:function(e,a){for(var t=a.split("."),i=0;i<t.length;i++){if(wasArray={flag:!1,value:0},-1!=t[i].indexOf("[")&&(wasArray.flag=!0,wasArray.value=t[i].substring(t[i].indexOf("[")+1,t[i].indexOf("]")),t[i]=t[i].split("[")[0]),!e||!e.hasOwnProperty(t[i]))return;e=wasArray.flag?e[t[i]][wasArray.value]:e[t[i]]}return"string"==typeof e?e.trim():e}(e,a);return void 0===i?t:i}};$("#btn-exit").click(function(){logout()});var toggleModule=function(e){if(!e.hasClass("animated"))if($content=$("#"+e.attr("data-target")),e.addClass("animated"),e.hasClass("is-open"))e.removeClass("is-open"),$content.slideUp(400,function(){e.removeClass("animated")});else{for(var a=0;a<$(".accordion .step-header").length;a++)element=$(".accordion .step-header")[a],$(element).hasClass("is-open")&&$(element).attr("data-target")!=e.attr("data-target")&&($idTemp=$("#"+$(element).attr("data-target")),$idTemp.slideUp());$(".accordion .step-header").not("data-target",e.attr("data-target")).removeClass("is-open"),e.addClass("is-open"),$content.slideDown(400,function(){e.removeClass("animated")})}};$(".accordion .step-header").click(function(e){hasAttr($(this),"data-catalog")&&"false"==$(this).attr("data-loaded")?(_lcatalog=$(this).attr("data-catalog"),fn_verifyCatalogs(loadModule.moduleCatalog[_lcatalog].list(),loadModule.moduleCatalog[_lcatalog].callback)):toggleModule($(this))}),$("#email, #email2, #email3").blur(function(){""!=$("#email").val()&&$("#email").val()==$("#email2").val()&&$("#email2").showError("No se permiten correos duplicados"),""!=$("#email2").val()&&$("#email2").val()==$("#email3").val()&&$("#email3").showError("No se permiten correos duplicados"),""!=$("#email").val()&&$("#email").val()==$("#email3").val()&&$("#email3").showError("No se permiten correos duplicados")}),$("#dbirthdate").comboSelect(day),$("#mbirthdate").comboSelect(month),fn_showAddFam=function(e,a){_scrollTo=hasAttr(e,"data-notify")?e.attr("data-notify"):"html",$(_scrollTo).animate({scrollTop:e.prev().offset().top-100},1e3,"swing",function(){notifyElem=e.prev(),0!=notifyElem.length&&notifyElem.hasClass("notification")&&notifyElem.remove(),loadTemplate(e,miniTemplates.btnnotification,{type:"error",title:"Datos obligatorios incompletos",message:"Por favor ingresa la información de tu familiar",button:"Agregar familiar",section:a},"before")})};var seedFindSchool,fnFillCatalogs=function(e,a,t){a=a||[],$("#"+e).comboSelect(a,t)};function saveglobal(){restExec({service:"UPDATE_ANNOUNCEMENT",data:{scholarshipProgram:{id:moduleInitData.announcement.scholarshipProgram.id},scholar:{Id:ivUser}},showWait:!0,success:rest_fnUpdateScholarshipAnnouncementStatus})}function changeStatusSel(e,a,t){_title=a||"Datos guardados",_message=t||"Tus datos se han almacenado correctamente, gracias",$elstatus=e.siblings(".step-header").find(".step-status"),e.siblings(".step-header").removeClass("is-open"),e.slideUp(),loadTemplate($("#modal_generic .body"),miniTemplates.success,{title:_title,message:_message})}function changeModuleSatus(e,a){$elstatus=e.siblings(".step-header").find(".step-status"),"complete"==a?($elstatus.removeClass("incomplete"),$elstatus.addClass("complete"),$elstatus.html('<i class="bbva-icon ui-checkmark-filled"></i>Completo')):($elstatus.removeClass("complete"),$elstatus.addClass("incomplete"),$elstatus.html('<i class="bbva-icon ui-warning"></i>Incompleto'))}function showReportNewSchool(){$("#reportschool_sec").slideDown(),$("#help_sh").slideDown("slow",function(){$("#help_sh").click(),helpScoolTooltip.show(),$("#st_btn_reportschool").click(function(){state_id=$("#state_s").getOptionSelected().id,mun_id=$("#municipalities_s").getOptionSelected().id,loadModule.getCatalog("CAT_TPO_ESCUELA-"+state_id+"-"+mun_id+"-"+moduleInitData.announcement.scholarshipProgram.id,function(){loadTemplate($("#modal_generic .body"),templates.school,{})}),$("#help_sh").click(),helpScoolTooltip.hide()}),$("#st_btn_cancel").click(function(){$("#help_sh").click(),helpScoolTooltip.hide()})})}function countCantFindSchool(){null==seedFindSchool&&(seedFindSchool=setTimeout(showReportNewSchool,12e4))}$("#dsclass").comboSelect(day),$("#msclass").comboSelect(month),$("#btn_fb").click(function(e){e.preventDefault(),loadTemplate($("#modal_generic .body"),templates.fb,{title:"Para vincular tu facebook, realiza los siguiente pasos"})}),$("#btn_savegd").data("complete",function(e){vali_date($("#mbirthdate").getOptionSelected().id+"/"+$("#dbirthdate").getOptionSelected().description+"/"+$("#ybirthdate").val())?restExec({service:"MODIF_UPLOADSCHOLAR",data:{userCurrent:"ALUMNO",registerType:"2",student:[{studentId:"",scholarUser:ivUser,programType:moduleInitData.announcement.scholarshipProgram.id,statusDispersion:"",originRegion:"",schoolCycle:"",cdAssignedCR:"",assignedCR:"",scholarNumber:"",accountNumber:"",folioPhoto:"",name:e.username,firstName:e.firstname,lastName:e.lastname,CURP:e.curp,scholarBirthdate:e.dbirthdate.description+"-"+e.mbirthdate.id+"-"+e.ybirthdate,gender:e.gender.id,schoolData:[{duration:"",turn:"",typeCareer:"",nameCareer:"",area:"",school:[{cdState:"",state:"",cdMunicipality:"",municipality:"",CCT:"",control:"",initials:"",type:"",name:"",domicile:""}]}],domicile:[{street:e.street,locality:"",numExterior:e.outdoornum,numInterior:e.interiornum,codePostal:e.zipcode,cdMunicipality:e.municipalities.id,municipality:e.municipalities.description,colony:e.neighborhood,cdState:e.state.id,state:e.state.description,betweenStreet:"",typeOfRoad1:"",andTheStreet:"",typeOfRoad2:"",behindStreet:"",typeOfRoad3:"",particularReferences:e.references}],contactInf:[{homePhone:e.phone,cellPhone:e.cellphone,messagePhone:e.errandsphone,email:e.email,email1:e.email2,email2:e.email3,facebook:""}],tutorData:[{tutorName:e.tutorname,firstNameTutor:e.tutorlastname,lastNameTutor:e.tutorslastname,kinship:e.relationship.description,kinshipType:e.o_relationship}],program:[{status:"",modalityParticipation:"",generation:"",originResources:"",projectSEPNumber:"",numberNMDP:"",schoolGrade:"",resultImpactEvaluation:""}]}]},showWait:!0,success:function(){loadModule.general(function(){changeStatusSel($("#general-data"))})}}):(fbdate=!1,$("#dbirthdate").showComboError("Fecha inválida"),$("#mbirthdate").showComboError("Fecha inválida"),$("html").animate({scrollTop:$("#dbirthdate").offset().top-200},1e3,"swing","before"))}),$("#formschdata").data("validations",function(e){return""!=e.schoolname||""==e.cct&&""==e.localities&&null==e.schoolT||($("#snerror").show(),!1)}),$("#btn_savesd").data("complete",function(e){var a="",t=!1;if("7"==moduleInitData.announcement.scholarshipProgram.id&&(a=e.msclass.id+"/"+e.dsclass.description+"/"+e.ysclass,t=!0),t&&!vali_date(a))return $("#dsclass").showComboError("Fecha inválida"),$("#msclass").showComboError("Fecha inválida"),void $("html").animate({scrollTop:$("#dsclass").offset().top-200},1e3,"swing","before");restExec({service:"UPDATE_SCHOLARINF",data:{id:ivUser,scholarshipProgram:[{id:moduleInitData.announcement.scholarshipProgram.id}],average:e.promgen,schooling:{schoolName:e.schoolname,location:{state:{id:e.state_s.id},municipality:{id:e.municipalities_s.id}},profession:{area:e.career_area,subArea:e.career_subarea,careerName:e.program_career,modality:e.modality,type:e.type_s,scholarShift:e.turn,duration:e.duration,classesStartDate:t?e.dsclass.description+"-"+e.msclass.id+"-"+e.ysclass:""},newLocation:{state:{id:__.get(e,"state_m.id",""),name:__.get(e,"state_m.description","")},municipality:{id:__.get(e,"municipalities_m.id",""),name:__.get(e,"municipalities_m.description","")}}},operation:{searchType:"CCT",searchDescription:e.schoolslist.keyWorkplace,userCurrent:"ALUMNO",keyWorkplace:e.schoolslist.keyWorkplace},changeAddress:!!t&&"SI"==e.change_h.id,expenses:{mounthlyRent:t&&""!=e.payment_rent?formatMoney(e.payment_rent,!0).replace(/,/g,"").replace(/\$/g,""):"",isPayRent:!!t&&"SI"==e.rent.id,transportationAmount:t&&""!=e.trans?formatMoney(e.trans,!0).replace(/,/g,"").replace(/\$/g,""):""}},showWait:!0,success:function(){loadModule.schoolData(function(){changeStatusSel($("#schoolar-data")),hideWait()})}})}),$("#btn_savesoc").data("complete",function(e){var a=!1,t=family.fromhome.getMembers();if("7"!=moduleInitData.announcement.scholarshipProgram.id&&family.fromhome.getTotal()<2)fn_showAddFam($("#fam_members"),"fromhome");else{for(var i in t)if("Sí"==t[i].familyBoss){a=!0;break}if(!a&&0<family.fromhome.getTotal())loadTemplate($("#modal_generic .body"),templates.selectboss,{members:t});else{var o=$("#social-data").find(".notification.error");if(0===o.length){for(allFamilies=[],_i=0;_i<family.fromhome.members.length;_i++)c_family=family.fromhome.members[_i],"OK"!=c_family.statusRelated&&(n_data={id:""==__.get(c_family,"relatedid","0")?"0":__.get(c_family,"relatedid","0"),name:c_family.fam_name,lastName:c_family.fam_appat,secondLastName:c_family.fam_apmat,statusRelatedPersonsInformation:family.unregistered?"Add":c_family.statusRelated,relationship:{id:c_family.fam_relationship.id,otherRelationshipDescription:c_family.fam_o_relationship},personDetail:{personType:"PERSONS_LIVE_HOME",isHeadOfHousehold:"Sí"==c_family.familyBoss?"true":"false",gender:{id:c_family.fam_gender.id},age:c_family.fam_age,maritalStatus:{id:c_family.fam_civil.id},education:{id:c_family.fam_schoollevel.id},isStudent:c_family.fam_studing.id,economicActivity:{id:c_family.fam_ocupation.id},healthCareEntity:{id:c_family.fam_medic.id,otherHealthCareEntity:c_family.fam_omedic},incomes:[{amount:c_family.total_f.toString().replace(/,/g,"").replace(/\$/g,""),currency:"MXN"}],hasWorkedLastMonth:c_family.fam_worked.id}},"0"==c_family.fam_otherschoolarship.id&&(n_data.personDetail.otherGovernmentScholarship={id:c_family.fam_programschoolarship.id,otherScholarshipProgramDescription:"6"!=c_family.fam_programschoolarship.id?c_family.fam_programschoolarship.description:c_family.sprogramname,otherGovernmentScholarshipType:{id:c_family.fam_kindschoolarship.id},incomes:[{amount:c_family.total_sf.toString().replace(/,/g,"").replace(/\$/g,""),currency:"MXN"}]}),allFamilies.push(n_data));for(_i=0;_i<family.awayfromhome.members.length;_i++)c_family=family.awayfromhome.members[_i],"OK"!=c_family.statusRelated&&(n_data={id:""==__.get(c_family,"relatedid","0")?"0":__.get(c_family,"relatedid","0"),name:c_family.fam_name,lastName:c_family.fam_appat,secondLastName:c_family.fam_apmat,statusRelatedPersonsInformation:__.get(c_family,"statusRelated","Add"),relationship:{id:c_family.fam_relationship.id,otherRelationshipDescription:c_family.fam_o_relationship},personDetail:{personType:"NOT_LIVE_HOME_ECONOMIC_SUPPORT",residencePlace:{id:c_family.fam_lives.id},incomes:[{amount:c_family.total_f.toString().replace(/,/g,"").replace(/\$/g,""),currency:"MXN"}],economicActivity:{id:c_family.fam_ocupation.id}}},allFamilies.push(n_data));if(c_family=family.bbva.member,0<Object.keys(family.bbva.member).length&&"OK"!=c_family.statusRelated&&(n_data={id:""==__.get(c_family,"relatedid","0")?"0":__.get(c_family,"relatedid","0"),name:c_family.name_fbbva,lastName:c_family.lastname_fbbva,secondLastName:c_family.slastname_fbbva,statusRelatedPersonsInformation:c_family.statusRelated,relationship:{id:c_family.relationship.id,otherRelationshipDescription:c_family.relationship_b_o},personDetail:{personType:"RELATIVE_WORKS_BBVA",professionPosition:c_family.workposition_fbbva,managementUnit:c_family.workstation_fbbva}},allFamilies.push(n_data)),0==allFamilies.length)return;restExec({service:family.unregistered?"CREATE_SOCINF":"UPDATE_SOCINF",data:{relatedPersons:allFamilies},hasUrlParam:!0,urlParam:{scholarId:ivUser},showWait:!0,success:function(){loadModule.sociodemographic(function(){changeStatusSel($("#social-data"))})},error:function(e){200==__.get(e,"status",0)?loadModule.sociodemographic(function(){changeStatusSel($("#social-data"))}):rest_fnShowError(e)}})}else $("html").animate({scrollTop:o.offset().top-100},2e3,"swing")}}}),$("#btn_savehd").data("complete",function(e){restExec({service:"UPDATE_HOMEINF",data:{operation:{userCurrent:"ALUMNO"},id:ivUser,homeInformation:{roomsNumber:e.roomsNumber.id,bedroomsNumber:e.bedroomsNumber.id,bathroomsNumber:e.bathroomsNumber.id,drainageType:e.drainageType,homeService:{waterServicesType:e.waterServicesType,lightServicesType:e.lightServicesType},wallMaterialsType:e.wallMaterialsType,cookingFuelType:e.cookingFuelType,ceilingMaterialsType:e.ceilingMaterialsType,floorMaterialsType:e.floorMaterialsType,belongings:{carsNumber:e.carsNumber.id,hasInternet:"SI"==e.hasInternet.id,hasComputer:"SI"==e.hasComputer.id,hasMicrowave:"SI"==e.hasMicrowave.id,hasPayTV:"SI"==e.hasPayTV.id,hasWashingMachine:"SI"==e.hasWashingMachine.id,hasMotorcycle:"SI"==e.hasMotorcycle.id}}},hasUrlParam:!0,urlParam:{scholarId:ivUser},showWait:!0,success:function(){loadModule.home(function(){changeStatusSel($("#inmueble-data"))})}})}),$("#btn_saveld").data("complete",function(){var e=[];$("#legal1, #legal2, #legal3").each(function(){$(this).isChecked()&&e.push({id:$(this).attr("data-legal-id"),isAccepted:"Y",consecutive:$(this).attr("data-legal-consecutive"),moduleId:31})}),restExec({service:"UPDATE_LEGAL",data:{legalDisclaimers:e,scholar:{id:ivUser},scholarshipProgram:{id:moduleInitData.announcement.scholarshipProgram.id}},showWait:!0,success:function(){loadModule.legalDisclaimer(function(){changeStatusSel($("#legal-data"))})}})}),$(".modal .icon-close").click(function(){$(this).parents(".modal").removeAttr("open"),callbackCloseModal()}),new Tooltip($("#ybirthdate").parent(".placeholder-wrapper"),{placement:"bottom",trigger:"focus",html:!0,closeOnClickOutside:!0,title:"Por ejemplo: 2001"}),new Tooltip($("#ysclass").parent(".placeholder-wrapper"),{placement:"bottom",trigger:"focus",html:!0,closeOnClickOutside:!0,title:"Por ejemplo: 2001"}),$("#search_by").onChecked(function(e){switch(countCantFindSchool(),$(".school-list").hide(),$("#schoolT").removeClass("required"),$("#schoolslist").unselect(),$("#btn_locality, #btn_type, #btn_cct").addClass("btn__disabled"),$("#cct, #localities").removeAttr("required"),$(".school-list").find(".list-result").addClass("disabled"),$("#schoolname").prop("disabled",!0),$(".school-list").show(),e.id){case"CCT":$("#cct").clearInput(),$("#cct").attr("required","required");break;case"LOC":$("#localities").attr("required","true"),state_id=$("#state_s").getOptionSelected().id,mun_id=$("#municipalities_s").getOptionSelected().id,loadModule.getCatalog("CAT_LOCALIDADES-"+state_id+"-"+mun_id+"-"+moduleInitData.announcement.scholarshipProgram.id,function(){$("#localitieslist").searchList({filterid:"description",filtertext:"description",items:catalogs["CAT_LOCALIDADES-"+$("#state_s").getOptionSelected().id+"-"+$("#municipalities_s").getOptionSelected().id+"-"+moduleInitData.announcement.scholarshipProgram.id]},function(e){$("#btn_locality").removeClass("btn__disabled")})});break;case"TYP":$("#schoolT").reset(),state_id=$("#state_s").getOptionSelected().id,mun_id=$("#municipalities_s").getOptionSelected().id,loadModule.getCatalog("CAT_TPO_ESCUELA-"+state_id+"-"+mun_id+"-"+moduleInitData.announcement.scholarshipProgram.id,function(){fnFillCatalogs("schoolT",catalogs["CAT_TPO_ESCUELA-"+state_id+"-"+mun_id+"-"+moduleInitData.announcement.scholarshipProgram.id],function(){$("#btn_type").removeClass("btn__disabled")})})}$(".search-filter .filter:not(.filter_"+e.id.toLowerCase()+")").hide("fast",function(){$(".search-filter .filter_"+e.id.toLowerCase()).show("fast")})}),$(".radio-section.search-by").onRadioReset(function(){$(".school-list").hide(),$("#schoolT").removeClass("required"),$("#schoolslist").unselect(),$("#btn_locality, #btn_type, #btn_cct").addClass("btn__disabled"),$("#cct, #localities").removeAttr("required"),$(".search-filter .filter").hide("fast")}),$("#cct").keyup(function(e){expRegs.CCT.regEx.test($(this).val().toUpperCase())?$("#btn_cct").removeClass("btn__disabled"):$("#btn_cct").addClass("btn__disabled")}),$(".btn_reportschool").click(function(){loadTemplate($("#modal_generic .body"),templates.school,{})}),$("#btn_locality, #btn_type, #btn_cct").click(function(){if($("#snerror").hide(),!$(this).hasClass("btn__disabled")){switch(searchType="",value="",this.id){case"btn_locality":searchType="location",value=$("#localities").val();break;case"btn_type":searchType="schoolAcronym",value=$("#schoolT").getOptionSelected().description;break;case"btn_cct":searchType="keyWorkplace",value=$("#cct").val()}(_dataListSchool={region:"",state:$("#state_s").getOptionSelected().description,municipality:$("#municipalities_s").getOptionSelected().description,location:"",schoolType:"",programScholarshipId:moduleInitData.announcement.scholarshipProgram.id,keyWorkplace:"",schoolOficialName:"",schoolAcronym:"",completeInformation:2,paginationIn:[{paginationKey:"1",pageSize:"100"}]})[searchType]=value,schools=[],getSchoolsList(),$(".school-list").slideDown("slow",function(){$(".school-list").find(".list-result").removeClass("disabled"),$("#schoolname").prop("disabled",!1),$("#schoolslist").onSelect(function(){clearTimeout(seedFindSchool),seedFindSchool=void 0})})}});var _dataListSchool,paginationSchoolList=function(e){"1"==e.paginationOut[0].hasMoreData&&(_dataListSchool.paginationIn[0].paginationKey=e.paginationOut[0].paginationKey,getSchoolsList()),$("#schoolslist").searchList({filterid:"keyWorkplace",filtertext:"schoolOficialName",items:schools})};function getSchoolsList(){restExec({service:"GET_SCHOOLS",data:_dataListSchool,showWait:!0,success:rest_fnListSchools,finallySuccess:paginationSchoolList,error:function(e){"01229001"==__.get(e,"responseJSON.code","")?0<schools.length?$("#schoolslist").searchList({filterid:"keyWorkplace",filtertext:"schoolOficialName",items:schools}):($("#schoolslist").searchList({filterid:"keyWorkplace",filtertext:"schoolOficialName",items:schools}),loadTemplate($("#modal_generic .body"),miniTemplates.error,{title:"No se encontraron escuelas",message:"No se encontraron resultados de escuelas con los filtros ingresados"})):rest_fnShowError(e)}})}function vali_date(e){var a=e[0]+e[1],t=new Date(e);return parseInt(a)==parseInt(t.getMonth()+1)}seedFindSchool=void 0,$("#n_family").onSelect(function(e){if(nfam=Number(e.id),nfam!=family.fromhome.getTotal())if(family.fromhome.total=nfam,family.fromhome.flags={type:"add",text:"Continuar"},nfam<family.fromhome.getTotal()){var a=family.fromhome.getMembers();a.splice(0,1),loadTemplate($("#modal_generic .body"),templates.deletefam,{title:"¿Deseas eliminar algún familiar?",message:"Selecciona el familiar que deseas eliminar(al eliminarlo ya no se podrá recuperar):",members:a,origin:"family",onAccept:function(){if(nFam=family.fromhome.getTotal(),newNfam=family.fromhome.total,dif=nFam-newNfam,cChecked=$("#list-member").find(".checkbox.checked").length,cChecked>dif)$("#formdeletefam").prev(".notification.error").length&&$("#formdeletefam").prev(".notification.error").remove(),loadTemplate($("#formdeletefam"),miniTemplates.notification,{type:"error",title:"Lo sentimos",message:"Sólo puedes eliminar "+dif+" familiar(es)"},"before");else if(cChecked<dif)$("#formdeletefam").prev(".notification.error").length&&$("#formdeletefam").prev(".notification.error").remove(),loadTemplate($("#formdeletefam"),miniTemplates.notification,{type:"error",title:"Lo sentimos",message:"Debes seleccionar "+dif+" familiar(es) o cancelar"},"before");else if(cChecked==dif){indexR=$("#list-member").find(".checkbox.checked"),bossFamilyDeleted=!1;for(var e=indexR.length-1;0<=e;e--){var a=$(indexR[e]).attr("data-index");"Sí"==family.fromhome.members[Number(a)].familyBoss&&(bossFamilyDeleted=!0),"true"==__.get(family.fromhome.members[Number(a)],"alreadyExists","false")?family.fromhome.members[Number(a)].statusRelated="Delete":family.fromhome.members.splice(Number(a),1)}if(bossFamilyDeleted)_famLst={members:family.fromhome.getMembers()},1==_famLst.members.length?(family.fromhome.members[0].familyBoss="Sí","true"==__.get(family.fromhome.members[0],"alreadyExists","false")&&(family.fromhome.members[0].statusRelated="Edit")):loadTemplate($("#modal_generic .body"),templates.selectboss,_famLst);else for(var t in fn_hideModal(),$("#nfamilylist").empty(),family.fromhome.members)family.fromhome.members[t].memberid=t,"Delete"!=family.fromhome.members[t].statusRelated&&loadTemplate($("#nfamilylist"),miniTemplates.familymembercard,family.fromhome.members[t],"append")}},onDecline:function(){$("#n_family").selectOptionId(family.fromhome.getTotal()),fn_hideModal()}})}else fn_verifyCatalogs(["CAT_INST_MEDICA","CAT_EDO_CIVIL","CAT_OCUPACION","CAT_TPO_APOYO","CAT_INST_APOYO","CAT_PARENTESCO-Miembro","CAT_MAX_NVL_ESTUDIO"],function(){loadTemplate($("#modal_generic .body"),templates.family,family.fromhome)});else $("#fam_members").prev().hasClass("error")&&$("#fam_members").prev().remove()}),$("#extrafamily").comboSelect(function(){_arrFamily=[];for(var e=0;e<10;e++)_arrFamily.push({id:""+e,description:""+e});return _arrFamily.push({id:"10",description:"10 o más"}),_arrFamily}(),function(e){if(nfam=Number(e.id),0==nfam&&0==family.awayfromhome.getTotal())$("#ext_family").prev().hasClass("error")&&$("#ext_family").prev().remove();else if(nfam!=family.awayfromhome.getTotal())family.awayfromhome.total=nfam,family.awayfromhome.flags={type:"add",text:"Continuar"},0===nfam?loadTemplate($("#modal_generic .body"),templates.conf,{title:"¿Deseas eliminar todos los familiares?",message:"Al eliminarlos ya no se podrán recuperar",onAccept:function(){for($("#ext_family").prev().hasClass("error")&&$("#ext_family").prev().remove(),fam_toDelete=[],a=0;a<family.awayfromhome.members.length;a++)e_fam=family.awayfromhome.members[a],"true"==__.get(e_fam,"alreadyExists","false")?family.awayfromhome.members[a].statusRelated="Delete":fam_toDelete.push(a);for(_ei=fam_toDelete.length-1;0<=_ei;_ei--)family.awayfromhome.members.splice(fam_toDelete[_ei],1);$("#nextrafamilylist").empty(),fn_hideModal()},onDecline:function(){$("#extrafamily").selectOptionId(family.awayfromhome.getTotal()),fn_hideModal()}}):nfam<family.awayfromhome.getTotal()?loadTemplate($("#modal_generic .body"),templates.deletefam,{title:"¿Deseas eliminar algún familiar?",message:"Selecciona el familiar que deseas eliminar(al eliminarlo ya no se podrá recuperar):",members:family.awayfromhome.getMembers(),origin:"efamily",onAccept:function(){if(nFam=family.awayfromhome.getTotal(),newNfam=family.awayfromhome.total,dif=nFam-newNfam,cChecked=$("#list-member").find(".checkbox.checked").length,cChecked>dif)$("#formdeletefam").prev(".notification.error").length&&$("#formdeletefam").prev(".notification.error").remove(),loadTemplate($("#formdeletefam"),miniTemplates.notification,{type:"error",title:"Lo sentimos",message:"Sólo puedes eliminar "+dif+" familiar(es)"},"before");else if(cChecked<dif)$("#formdeletefam").prev(".notification.error").length&&$("#formdeletefam").prev(".notification.error").remove(),loadTemplate($("#formdeletefam"),miniTemplates.notification,{type:"error",title:"Lo sentimos",message:"Debes seleccionar "+dif+" familiar(es) o cancelar"},"before");else if(cChecked==dif){indexR=$("#list-member").find(".checkbox.checked");for(var e=indexR.length-1;0<=e;e--){var a=$(indexR[e]).attr("data-index");"true"==__.get(family.awayfromhome.members[Number(a)],"alreadyExists","false")?family.awayfromhome.members[Number(a)].statusRelated="Delete":family.awayfromhome.members.splice(Number(a),1)}for(var t in fn_hideModal(),$("#nextrafamilylist").empty(),family.awayfromhome.members)family.awayfromhome.members[t].memberid=t,"Delete"!=family.awayfromhome.members[t].statusRelated&&loadTemplate($("#nextrafamilylist"),miniTemplates.efamilymembercard,family.awayfromhome.members[t],"append")}},onDecline:function(){fn_hideModal(),$("#extrafamily").selectOptionId(family.awayfromhome.getTotal())}}):nfam!=family.awayfromhome.getTotal()&&fn_verifyCatalogs(["CAT_OCUPACION","CAT_RESIDENCIA","CAT_PARENTESCO-Miembro"],function(){loadTemplate($("#modal_generic .body"),templates.efamily,family.awayfromhome)});else for(var a in family.awayfromhome.getTotal()==nfam&&$("#ext_family").prev().hasClass("error")&&$("#ext_family").prev().remove(),$("#nextrafamilylist").empty(),family.awayfromhome.members)"Delete"!=family.awayfromhome.members[a].statusRelated&&loadTemplate($("#nextrafamilylist"),miniTemplates.efamilymembercard,family.awayfromhome.members[a],"append")}),$("#bbvafamily").onChecked(function(e){$("#fam_bbvacard").html(""),"0"==e.id?0==Object.keys(family.bbva.member).length?(family.bbva.flag="create",fn_verifyCatalogs(["CAT_PARENTESCO-Soporte"],function(){loadTemplate($("#modal_generic .body"),templates.fambbva,{title:"Modifica la información de tu familiar"})})):("true"==__.get(family.bbva.member,"alreadyExists","false")?"Delete"==__.get(family.bbva.member,"statusRelated","")&&(family.bbva.member.statusRelated="Edit"):family.bbva.member.statusRelated="Add",family.bbva.flag="edit",loadTemplate($("#fam_bbvacard"),miniTemplates.familybbvacard,family.bbva.member),family.bbva.member&&$("#bbva_employee").prev(".notification.error").length&&$("#bbva_employee").prev(".notification.error").slideUp("slow")):($("#bbva_employee").prev(".notification.error").length&&$("#bbva_employee").prev(".notification.error").remove(),"true"==__.get(family.bbva.member,"alreadyExists","false")?family.bbva.member.statusRelated="Delete":(family.bbva.member={},family.bbva.flag="create"))}),$("#roomsNumber").comboSelect(function(){_arrNumRooms=[];for(var e=1;e<20;e++)_arrNumRooms.push({id:""+e,description:""+e});return _arrNumRooms.push({id:"20",description:"20 o más"}),_arrNumRooms}()),$("#bedroomsNumber").comboSelect(function(){_arrNumRooms=[];for(var e=0;e<4;e++)_arrNumRooms.push({id:""+e,description:""+e});return _arrNumRooms.push({id:"4",description:"4 o más"}),_arrNumRooms}()),$(".o_two").comboSelect(function(){_arr_0_2=[];for(var e=0;e<2;e++)_arr_0_2.push({id:""+e,description:""+e});return _arr_0_2.push({id:"2",description:"2 o más"}),_arr_0_2}()),$(".r-options").onChecked(),$(".query_curp").click(function(){window.open("https://www.gob.mx/curp/","_blank")}),$(".query_privacy").click(function(){window.open(" https://www.fundacionbbvabancomer.org/aviso-de-privacidad/","_blank")}),$("#fam_mig").onSelect(function(e){"0"==e.id?($("#y_fam_mig").slideDown("slow"),$("#n_fam_mig").addClass("required")):($("#y_fam_mig").slideUp("slow"),$("#n_fam_mig").removeClass("required"),$("#fam_mig_cards").empty())}),$("#change_h").onChecked(function(e){"SI"==e.id?($("#migrate_area").slideDown(),$("#migrate_area .form-group-select").addClass("required"),$("#migrate_area input#trans").attr("required",""),$("#rent").addClass("required")):($("#migrate_area").slideUp(),$("#migrate_area .form-group-select").removeClass("required").removeComboError(),$("#migrate_area input#trans").removeAttr("required"),$("#migrate_area input#trans").clearInput(),$("#rent").selectRadioId("NO").clearRadio().removeClass("required"))}),$("#rent").onChecked(function(e){"SI"==e.id?($("#pay_rent").slideDown("slow"),$("#payment_rent").attr("required","required")):($("#pay_rent").slideUp("slow"),$("#payment_rent").removeAttr("required"),$("#payment_rent").clearInput())}),$("#dbirthdate").onSelect(function(){fbdate||(vali_date($("#mbirthdate").getOptionSelected().id+"/"+$("#dbirthdate").getOptionSelected().description+"/"+$("#ybirthdate").val())?(fbdate=!0,$("#mbirthdate").removeComboError()):$(this).showComboError("Fecha inválida"))}),$("#mbirthdate").onSelect(function(){fbdate||(vali_date($("#mbirthdate").getOptionSelected().id+"/"+$("#dbirthdate").getOptionSelected().description+"/"+$("#ybirthdate").val())?(fbdate=!0,$("#dbirthdate").removeComboError()):$(this).showComboError("Fecha inválida"))}),$("#dsclass").onSelect(function(){fcdate||(vali_date($("#msclass").getOptionSelected().id+"/"+$("#dsclass").getOptionSelected().description+"/"+$("#ysclass").val())?(fcdate=!0,$("#msclass").removeComboError()):$(this).showComboError("Fecha inválida"))}),$("#msclass").onSelect(function(){fcdate||(vali_date($("#msclass").getOptionSelected().id+"/"+$("#dsclass").getOptionSelected().description+"/"+$("#ysclass").val())?(fcdate=!0,$("#dsclass").removeComboError()):$(this).showComboError("Fecha inválida"))}),$("#btn_save_all").click(function(){if(_StateId=moduleInitData.schoolData.schooling.location.state.id,_StateDesc="",_MunicipalityDesc="",0!=_StateId){for(_i=0;_i<stateTransactions.length;_i++)if(stateTransactions[_i].id==_StateId){_StateDesc=stateTransactions[_i].description;break}for(_i=0;_i<municipalityTransactions[_StateId].length;_i++)if(municipalityTransactions[_StateId][_i].id==moduleInitData.schoolData.schooling.location.municipality.id){_MunicipalityDesc=municipalityTransactions[_StateId][_i].description;break}}else _StateDesc="PENDIENTE",_MunicipalityDesc="PENDIENTE";var e="",a="No";switch(moduleInitData.announcement.scholarshipProgram.id){case"1":e="primaria";break;case"2":e="secundaria";break;case"7":e="preparatoria";break;default:e="Desconocido"}0<Object.keys(family.bbva.member).length&&(a="Si"),loadTemplate($("#modal_generic .body"),templates.confirmAllData,{tutorName:moduleInitData.general.student[0].tutorData[0].tutorName,tutorLastName:moduleInitData.general.student[0].tutorData[0].firstNameTutor,tutorSecondLastName:moduleInitData.general.student[0].tutorData[0].lastaNameTutor,tutorRelationship:moduleInitData.general.student[0].tutorData[0].kinship,name:moduleInitData.general.student[0].name,lastName:moduleInitData.general.student[0].firstName,secondLastName:moduleInitData.general.student[0].lastName,birthdate:moduleInitData.general.student[0].scholarBirthdate,gender:moduleInitData.general.student[0].gender,curp:moduleInitData.general.student[0].CURP,street:moduleInitData.general.student[0].domicile[0].street,interiorNumber:moduleInitData.general.student[0].domicile[0].numInterior,outdoorNumber:moduleInitData.general.student[0].domicile[0].numExterior,zipcode:moduleInitData.general.student[0].domicile[0].codePostal,colony:moduleInitData.general.student[0].domicile[0].colony,municipality:moduleInitData.general.student[0].domicile[0].municipality,state:moduleInitData.general.student[0].domicile[0].state,references:moduleInitData.general.student[0].domicile[0].particularReferences,homePhone:moduleInitData.general.student[0].contactInf[0].homePhone,cellPhone:moduleInitData.general.student[0].contactInf[0].cellPhone,errandsphone:moduleInitData.general.student[0].contactInf[0].messagePhone,email:moduleInitData.general.student[0].contactInf[0].email,email2:moduleInitData.general.student[0].contactInf[0].email1,email3:moduleInitData.general.student[0].contactInf[0].email2,levelDescription:e,average:moduleInitData.schoolData.average,municipalitySchool:_MunicipalityDesc,stateSchool:_StateDesc,schoolName:moduleInitData.schoolData.schooling.schoolName,turn:moduleInitData.schoolData.schooling.profession.scholarShift.description,flagCareer:"Universidad"==e?"block":"none",area:moduleInitData.schoolData.schooling.profession.area.description,subarea:moduleInitData.schoolData.schooling.profession.subArea.description,career:moduleInitData.schoolData.schooling.profession.careerName,modality:moduleInitData.schoolData.schooling.profession.modality.description,careerType:moduleInitData.schoolData.schooling.profession.type.description,duration:moduleInitData.schoolData.schooling.profession.duration.description,spendingOnTransportation:formatMoney(moduleInitData.schoolData.expenses.transportationAmount),startClassDate:moduleInitData.schoolData.schooling.profession.classesStartDate,changeHome:1==moduleInitData.schoolData.changeAddress?"Sí":"No",flagChangeHome:1==moduleInitData.schoolData.changeAddress?"block":"none",municipalityChange:moduleInitData.schoolData.schooling.newLocation.municipality.name,stateChange:moduleInitData.schoolData.schooling.newLocation.state.name,rent:moduleInitData.schoolData.expenses.isPayRent?"Sí":"No",flagIsRent:moduleInitData.schoolData.expenses.isPayRent?"block":"none",paymentRent:formatMoney(moduleInitData.schoolData.expenses.mounthlyRent),bbvaFamily:a,flagBbvaFam:"Si"==a?"block":"none",numRooms:"20"==moduleInitData.home.homeInformation.roomsNumber?moduleInitData.home.homeInformation.roomsNumber+" o más":moduleInitData.home.homeInformation.roomsNumber,numRoomsSleep:"4"==moduleInitData.home.homeInformation.bedroomsNumber?moduleInitData.home.homeInformation.bedroomsNumber+" o más":moduleInitData.home.homeInformation.bedroomsNumber,numBath:"2"==moduleInitData.home.homeInformation.bathroomsNumber?moduleInitData.home.homeInformation.bathroomsNumber+" o más":moduleInitData.home.homeInformation.bathroomsNumber,water:moduleInitData.home.homeInformation.homeService.waterServicesType.description,drain:moduleInitData.home.homeInformation.drainageType.description,light:moduleInitData.home.homeInformation.homeService.lightServicesType.description,fuel:moduleInitData.home.homeInformation.cookingFuelType.description,wall:moduleInitData.home.homeInformation.wallMaterialsType.description,roof:moduleInitData.home.homeInformation.ceilingMaterialsType.description,floor:moduleInitData.home.homeInformation.floorMaterialsType.description,cars:"2"==moduleInitData.home.homeInformation.belongings.carsNumber?moduleInitData.home.homeInformation.belongings.carsNumber+" o más":moduleInitData.home.homeInformation.belongings.carsNumber,internet:1==moduleInitData.home.homeInformation.belongings.hasInternet?"Sí":"No",laptop:1==moduleInitData.home.homeInformation.belongings.hasComputer?"Sí":"No",washingMachine:1==moduleInitData.home.homeInformation.belongings.hasWashingMachine?"Sí":"No",microwave:1==moduleInitData.home.homeInformation.belongings.hasMicrowave?"Sí":"No",tvService:1==moduleInitData.home.homeInformation.belongings.hasPayTV?"Sí":"No",motorcyle:1==moduleInitData.home.homeInformation.belongings.hasMotorcycle?"Sí":"No",urlLegal:moduleInitData.legalDisclaimer.legalDisclaimers[0].link,textLegal:moduleInitData.legalDisclaimer.legalDisclaimers[0].description.split("|")[1],legal1:moduleInitData.legalDisclaimer.legalDisclaimers[0].description.split("|")[0],urlLegal2:moduleInitData.legalDisclaimer.legalDisclaimers[1].link,textLegal2:moduleInitData.legalDisclaimer.legalDisclaimers[1].description.split("|")[1],legal2:moduleInitData.legalDisclaimer.legalDisclaimers[1].description.split("|")[0],urlLegal3:moduleInitData.legalDisclaimer.legalDisclaimers[2].link,textLegal3:moduleInitData.legalDisclaimer.legalDisclaimers[2].description.split("|")[1],legal3:moduleInitData.legalDisclaimer.legalDisclaimers[2].description.split("|")[0],onAccept:function(){fn_hideModal(),saveglobal()},onDecline:function(){fn_hideModal()}})});var loadModule={getCatalog:function(a,e){null==catalogs[a]||0==catalogs[a].length?restExec({service:"LIST_CATALOGS",type:"GET",async:!0,showWait:!0,hasUrlParam:!0,urlParam:{catalog:a},data:{},finallyError:function(){e()},finallySuccess:[function(e){rest_fnGetSchoolCatalog(a,e)},e]}):e(catalogs[a])},getJSONCatalog:function(a,e){return{service:"LIST_CATALOGS",type:"GET",async:!1,hasUrlParam:!0,urlParam:{catalog:a},data:{},finallySuccess:[function(e){rest_fnGetSchoolCatalog(a,e)},e||rest_fnNothig]}},general:function(e){restExec({service:"SCHOLAR_DETAIL",type:"POST",data:{userScholar:ivUser,registerType:"2"},success:rest_fnGetGeneralData,finallySuccess:[loadModule.ensureFun(e),loadModule.checkStatus],error:function(e){"01229001"!=__.get(e,"responseJSON.code","")?rest_fnShowError(e):resetForm($("#formgendata"))}})},schoolData:function(e){restExec({service:"GET_SCHOLARINF",type:"GET",hasUrlParam:!0,async:!1,urlParam:{scholarId:ivUser,programScholarshipId:moduleInitData.announcement.scholarshipProgram.id},data:{},success:rest_fnGetScholarInf,finallySuccess:[loadModule.ensureFun(e),loadModule.checkStatus],error:function(e){"01229001"!=__.get(e,"responseJSON.code","")?rest_fnShowError(e):resetForm($("#formschdata"))}})},sociodemographic:function(e){restExec({service:"GET_SOCINF",type:"GET",hasUrlParam:!0,urlParam:{scholarId:ivUser,scholarshipProgramId:moduleInitData.announcement.scholarshipProgram.id},data:{},success:rest_fnGetSocialData,finallySuccess:[loadModule.ensureFun(e),loadModule.checkStatus],error:function(e){"01229001"!=__.get(e,"responseJSON.code","")?rest_fnShowError(e):(resetForm($("#formsocdata")),family.fromhome.members=[],family.awayfromhome.members=[],family.bbva.member={},$("#nfamilylist").empty(),$("#nextrafamilylist").empty(),$("#fam_bbvacard").empty())}})},home:function(e){restExec({service:"GET_HOMEINF",type:"GET",hasUrlParam:!0,urlParam:{scholarId:ivUser,programScholarshipId:moduleInitData.announcement.scholarshipProgram.id},data:{},success:rest_fnGetHomeServices,finallySuccess:[loadModule.ensureFun(e),loadModule.checkStatus],error:function(e){"01229001"!=__.get(e,"responseJSON.code","")&&"01229008"!=__.get(e,"responseJSON.code","")?rest_fnShowError(e):resetForm($("#formhdata"))}})},legalDisclaimer:function(e){restExec({service:"GET_LEGAL",type:"GET",hasUrlParam:!0,urlParam:{scholarId:ivUser,scholarshipProgramId:moduleInitData.announcement.scholarshipProgram.id,moduleID:31},data:{},success:rest_fnGetLegalDisclaimers,finallySuccess:[loadModule.ensureFun(e),loadModule.checkStatus]})},scholarshipAnnouncement:function(e){restExec({service:"GET_ANNOUNCEMENT",type:"GET",hasUrlParam:!0,showWait:!0,urlParam:{registerType:"CO",scholarId:ivUser},data:{},success:rest_fnGetScholarshipAnnouncement,finallySuccess:[loadModule.ensureFun(e),loadModule.checkStatus],finallyError:function(){$(".content").hide()}})},moduleCatalog:{general:{list:function(){return["CAT_Tipo_Alta","CAT_BANK","CAT_CREDITMORTGAGE","CAT_CREDITCOMMERCIAL","CAT_COFINAVIT","CAT_GRAVAMEN"]},callback:function(){fnFillCatalogs("relationship",__.get(catalogs,"CAT_Tipo_Alta",[]),function(e){"25"==e.id?($("#o_relationship").clearInput(),$("#o_relationship").attr("required","required"),$("#other_relationship").slideDown()):($("#o_relationship").removeAttr("required"),$("#other_relationship").slideUp(),$("#o_relationship").clearInput())}),fnFillCatalogs("generatingbank",__.get(catalogs,"CAT_BANK",[]),function(e){}),fnFillCatalogs("mortgagecredittype",__.get(catalogs,"CAT_CREDITMORTGAGE",[]),function(e){}),fnFillCatalogs("commercialcredit",__.get(catalogs,"CAT_CREDITCOMMERCIAL",[]),function(e){}),fnFillCatalogs("cofinavit",__.get(catalogs,"CAT_COFINAVIT",[]),function(e){}),fnFillCatalogs("barzon",__.get(catalogs,"CAT_COFINAVIT",[]),function(e){}),fnFillCatalogs("gravamen",__.get(catalogs,"CAT_GRAVAMEN",[]),function(e){}),$('[data-target="general-data"]').attr("data-loaded","true"),void 0!==moduleInitData.general&&rest_fnGetGeneralData(moduleInitData.general),toggleModule($('[data-target="general-data"]'))}},schoolData:{list:function(){return["CAT_TYPEPROPERTY"]},callback:function(){fnFillCatalogs("typepropertie",__.get(catalogs,"CAT_TYPEPROPERTY",[])),$('[data-target="schoolar-data"]').attr("data-loaded","true"),void 0!==moduleInitData.schoolData&&rest_fnGetScholarInf(moduleInitData.schoolData),toggleModule($('[data-target="schoolar-data"]'))}},dataInmueble:{list:function(){return["CAT_TYPEPROPERTY","CAT_SUBTYPEPROPERTY","CAT_STATE"]},callback:function(){fnFillCatalogs("typepropertie",__.get(catalogs,"CAT_TYPEPROPERTY",[])),fnFillCatalogs("subtypeproperty",__.get(catalogs,"CAT_SUBTYPEPROPERTY",[])),fnFillCatalogs("propertystate",__.get(catalogs,"CAT_STATE",[])),fnFillCatalogs("municipalities_d",__.get(catalogs,"CAT_STATE",[])),$('[data-target="inmueble-data"]').attr("data-loaded","true"),void 0!==moduleInitData.home&&rest_fnGetHomeServices(moduleInitData.home),toggleModule($('[data-target="inmueble-data"]'))}}},checkStatus:function(){setTimeout(function(){0==$(".step-header .step-status.incomplete").length&&"0"==__.get(moduleInitData,"announcement.globalStatus","0")?$(".submtbtn.send").removeAttr("style"):$(".submtbtn.send").attr("style","display: none")},450)},ensureFun:function(e){return"function"==typeof e?e:rest_fnNothig},getStates:function(e){null==stateTransactions||0==stateTransactions.length?restExec({showWait:!0,service:"GET_STATES",type:"POST",data:{},asyn:!1,finallySuccess:[function(e){rest_fnGetStates(e)},e],finallyError:[function(e){rest_fnGetStates(e)},e]}):e(stateTransactions)},getMunicipalities:function(a,e){null==municipalityTransactions[a]||0==municipalityTransactions[a].length?restExec({showWait:!0,service:"GET_MUNICIPALITY",type:"POST",asyn:!1,data:{state:a},finallySuccess:[function(e){rest_fnGetMunicipalities(a,e)},e],finallyError:[function(e){rest_fnGetMunicipalities(a,e)},e]}):e(municipalityTransactions[a])}},loadMainModules=function(){$("#n_family").comboSelect(function(){_arrFamily=[];for(var e="7"==moduleInitData.announcement.scholarshipProgram.id?1:2;e<20;e++)_arrFamily.push({id:""+e,description:""+e});return _arrFamily.push({id:"20",description:"20 o más"}),_arrFamily}()),LIST_SERVICES.listRestExec({showWait:!0,service:"GET_STATES",type:"POST",data:{},asyn:!1,finallySuccess:[function(e){rest_fnGetStates(e)},function(){$("#state").comboSelect(stateTransactions,function(e){$("#municipalities").reset(),loadModule.getMunicipalities(e.id,function(){$("#municipalities").comboSelect(municipalityTransactions[e.id])})}),$("#state_s").comboSelect(stateTransactions,function(e){$("#municipalities_s").reset(),$("#school_s").css("display","none"),$(".radio-section.search-by").clearRadio().removeClass("required"),0!=e.id&&"0"!=e.id||(_prId=moduleInitData.announcement.scholarshipProgram.id,municipalityTransactions[0]=[{id:0,description:dommySchools.getDommyDescription()}]),loadModule.getMunicipalities(e.id,function(){$("#municipalities_s").comboSelect(municipalityTransactions[e.id],function(){$("#search_by .radio-buttons").removeClass("disabled"),$("input#cct").prop("disabled",!1),$("#school_s").css("display","block"),$(".radio-section.search-by").clearRadio().addClass("required")})})}),$("#state_m").comboSelect(stateTransactions,function(e){$("#municipalities_m").reset(),loadModule.getMunicipalities(e.id,function(){$("#municipalities_m").comboSelect(municipalityTransactions[e.id])})})}]}),LIST_SERVICES.listRestExec({service:"SCHOLAR_DETAIL",type:"POST",data:{userScholar:ivUser,registerType:"2"},success:rest_fnGetGeneralData,ignoreError:!0,error:function(e){"01229001"!=__.get(e,"responseJSON.code","")&&LIST_SERVICES.errors.push(e)}})},loadNextModules=function(e){"function"!=typeof e&&(e=loadModule.checkStatus),LIST_SERVICES.listRestExec({service:"GET_SCHOLARINF",type:"GET",hasUrlParam:!0,urlParam:{scholarId:ivUser,programScholarshipId:moduleInitData.announcement.scholarshipProgram.id},data:{},success:rest_fnGetScholarInf,ignoreError:!0,error:function(e){"01229001"!=__.get(e,"responseJSON.code","")&&LIST_SERVICES.errors.push(e)}}),LIST_SERVICES.listRestExec({service:"GET_SOCINF",type:"GET",hasUrlParam:!0,urlParam:{scholarId:ivUser,scholarshipProgramId:moduleInitData.announcement.scholarshipProgram.id},data:{},success:rest_fnGetSocialData,ignoreError:!0,error:function(e){"01229001"!=__.get(e,"responseJSON.code","")&&LIST_SERVICES.errors.push(e)}}),LIST_SERVICES.listRestExec({service:"GET_HOMEINF",type:"GET",hasUrlParam:!0,urlParam:{scholarId:ivUser,programScholarshipId:moduleInitData.announcement.scholarshipProgram.id},data:{},success:rest_fnGetHomeServices,ignoreError:!0,error:function(e){"01229001"!=__.get(e,"responseJSON.code","")&&"01229008"!=__.get(e,"responseJSON.code","")&&LIST_SERVICES.errors.push(e)}}),LIST_SERVICES.listRestExec({service:"GET_LEGAL",type:"GET",hasUrlParam:!0,urlParam:{scholarId:ivUser,scholarshipProgramId:moduleInitData.announcement.scholarshipProgram.id,moduleID:31},data:{},success:rest_fnGetLegalDisclaimers},e)};expRegs.FOL.regEx.test(ivUser)?loadModule.scholarshipAnnouncement():expRegs.FUN.regEx.test(ivUser)&&restExec({service:"SCHOLAR_DETAIL",type:"POST",data:{userScholar:ivUser,registerType:"2"},showWait:!0,finallyError:function(){$(".content").hide()},success:rest_fnGetGeneralDataFun}),Object.keys(templates).forEach(function(a){$.get(templates[a].path,function(e){templates[a].html=e})}),$("#currentYear").text((new Date).getFullYear());